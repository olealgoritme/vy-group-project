__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.writeValidationDataToDatabase=function(t){var o,u;return regeneratorRuntime.async(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,regeneratorRuntime.awrap((0,n.getDatabase)());case 3:return o=c.sent,u=t.map(function(t){return[E,[String(t.ticketId),t.validationDataValidDate,JSON.stringify(t)]]}),c.next=7,regeneratorRuntime.awrap(o.sqlBatch([b].concat(v(s=u)||f(s)||p())));case 7:c.next=13;break;case 9:throw c.prev=9,c.t0=c.catch(0),console.log("[validation-data-db] Error: "+c.t0.message),new Error('failed to perform DB operation: '+c.t0.message);case 13:case"end":return c.stop()}var s},null,null,[[0,9]])},e.readSingleValidationDataFromDatabase=function(t){var o,c,s,l,p;return regeneratorRuntime.async(function(f){for(;;)switch(f.prev=f.next){case 0:if(f.prev=0,t){f.next=3;break}throw Error('You need to provide a ticketId');case 3:return f.next=5,regeneratorRuntime.awrap((0,n.getDatabase)());case 5:return o=f.sent,f.next=8,regeneratorRuntime.awrap(o.executeSql(b));case 8:return f.next=10,regeneratorRuntime.awrap(o.executeSql(w(),[t]));case 10:if(c=f.sent,s=u(c,1),1===(l=s[0]).rows.length){f.next=15;break}return f.abrupt("return",void 0);case 15:return p=JSON.parse(l.rows.item(0).value),f.abrupt("return",p);case 19:throw f.prev=19,f.t0=f.catch(0),console.log("[validation-data-db] Error: "+f.t0.message),new Error('failed to perform DB operation: '+f.t0.message);case 23:case"end":return f.stop()}},null,null,[[0,19]])},e.readAllValidationDataFromDatabase=function(){var t,o,c,s,l,p;return regeneratorRuntime.async(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,regeneratorRuntime.awrap((0,n.getDatabase)());case 3:return t=f.sent,f.next=6,regeneratorRuntime.awrap(t.executeSql(b));case 6:return f.next=8,regeneratorRuntime.awrap(t.executeSql(y));case 8:if(o=f.sent,c=u(o,1),0!==(s=c[0]).rows.length){f.next=13;break}return f.abrupt("return",[]);case 13:for(l=[],p=0;p<s.rows.length;p++)l.push(JSON.parse(s.rows.item(p).value));return f.abrupt("return",l);case 18:throw f.prev=18,f.t0=f.catch(0),console.log("[validation-data-db] Error: "+f.t0.message),new Error('failed to perform DB operation: '+f.t0.message);case 22:case"end":return f.stop()}},null,null,[[0,18]])},e.deleteInvalidValidationDataFromDatabase=function(){var t;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regeneratorRuntime.awrap((0,n.getDatabase)());case 3:return t=o.sent,o.next=6,regeneratorRuntime.awrap(t.sqlBatch([b,x()]));case 6:o.next=11;break;case 8:o.prev=8,o.t0=o.catch(0),console.log("[validation-data-db] Error: "+o.t0.message);case 11:case"end":return o.stop()}},null,null,[[0,8]])},e.emptyTicketValidationDataDatabase=function(){var t;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regeneratorRuntime.awrap((0,n.getDatabase)());case 3:return t=o.sent,o.next=6,regeneratorRuntime.awrap(t.executeSql(D));case 6:o.next=11;break;case 8:o.prev=8,o.t0=o.catch(0),console.log("[validation-data-db] Error: "+o.t0.message);case 11:case"end":return o.stop()}},null,null,[[0,8]])};var t,n=r(d[0]),o=(t=r(d[1]))&&t.__esModule?t:{default:t};function u(t,n){return l(t)||s(t,n)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(t,n){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var o=[],u=!0,c=!1,s=void 0;try{for(var l,p=t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();!(u=(l=p.next()).done)&&(o.push(l.value),!n||o.length!==n);u=!0);}catch(t){c=!0,s=t}finally{try{u||null==p.return||p.return()}finally{if(c)throw s}}return o}}function l(t){if(Array.isArray(t))return t}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function v(t){if(Array.isArray(t)){for(var n=0,o=new Array(t.length);n<t.length;n++)o[n]=t[n];return o}}var b="\n    CREATE TABLE IF NOT EXISTS validationData (\n        ticketId                TEXT            NOT NULL,\n        validDate               DATE            NOT NULL,\n        value                   TEXT            NOT NULL,\n        UNIQUE (ticketId, validDate) ON CONFLICT REPLACE\n    );\n    ",D='DELETE FROM validationData',E="INSERT OR REPLACE INTO validationData (ticketId, validDate, value) VALUES (?,?,?)",w=function(){return"\n        SELECT value FROM validationData\n        WHERE date(validDate) = date('"+(0,o.default)().format('YYYY-MM-DD')+"')\n        AND ticketId = ?\n        LIMIT 1\n    "},y='SELECT value FROM validationData',x=function(){return"\n        DELETE FROM validationData\n        WHERE date(validDate) < date('"+(0,o.default)().subtract(1,'days').format('YYYY-MM-DD')+"')\n    "}},665,[622,628]);