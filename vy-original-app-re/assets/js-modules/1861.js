__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=w(r(d[0])),n=r(d[1]),o=v(r(d[2])),s=r(d[3]),c=r(d[4]),u=v(r(d[5])),l=w(r(d[6])),f=v(r(d[7])),p=r(d[8]),h=v(r(d[9])),y=v(r(d[10])),b=r(d[11]);function v(t){return t&&t.__esModule?t:{default:t}}function O(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return O=function(){return t},t}function w(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=O();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u=s?Object.getOwnPropertyDescriptor(t,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}function _(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function j(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?_(Object(o),!0).forEach(function(n){C(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):_(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function C(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function P(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function E(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&S(t,n)}function S(t,n){return(S=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var k=(function(v){function O(t){var n,o,s;return P(this,O),o=this,(n=!(s=M(O).call(this,t))||"object"!=typeof s&&"function"!=typeof s?R(o):s).state={consents:[],errorMessage:void 0,isInitiallyLoading:!0,isRefreshing:!1},n.handleToggleChange=n.handleToggleChange.bind(R(n)),n.handleRefresh=n.handleRefresh.bind(R(n)),n}var w,_,C;return T(O,t.Component),w=O,(_=[{key:"componentDidMount",value:function(){this.fetchConsents()}},{key:"fetchConsents",value:function(){var t,n;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.props.navigation.state.params.userId,o.prev=1,o.next=4,regeneratorRuntime.awrap((0,s.getConsentsForUser)(t));case 4:n=o.sent,this.setState({consents:n,errorMessage:void 0,isRefreshing:!1}),o.next=12;break;case 8:o.prev=8,o.t0=o.catch(1),console.log('Error fetching consents: '+o.t0),this.setState({errorMessage:(0,l.infoMessage)((0,h.default)('error_fetching_or_updating_consents'))});case 12:return o.prev=12,this.setState({isInitiallyLoading:!1}),o.finish(12);case 15:case"end":return o.stop()}},null,this,[[1,8,12,15]])}},{key:"handleToggleChange",value:function(t,n){var s=this.state.consents.map(function(s){return s.code===t?(n&&o.default.TOGGLED_COMMUNICATION_CONSENT({summary:s.summary}),j({},s,{state:n})):s});this.setState({consents:s},this.updateConsents)}},{key:"updateConsents",value:function(){var t,n;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.props.navigation.state.params.userId,n=this.state.consents.map(function(t){return{code:t.code,state:t.state}}),o.prev=2,o.next=5,regeneratorRuntime.awrap((0,s.updateConsentsForUser)(t,n));case 5:o.next=11;break;case 7:o.prev=7,o.t0=o.catch(2),console.log('Error updating consents: '+o.t0),this.setState({consents:[],errorMessage:(0,l.infoMessage)((0,h.default)('error_fetching_or_updating_consents'))});case 11:case"end":return o.stop()}},null,this,[[2,7]])}},{key:"handleRefresh",value:function(){this.setState({isRefreshing:!0}),this.fetchConsents()}},{key:"render",value:function(){var o=this.state,s=o.consents,v=o.errorMessage,O=o.isInitiallyLoading,w=o.isRefreshing;return t.default.createElement(n.ScrollView,{showsVerticalScrollIndicator:!0,contentContainerStyle:{flexGrow:1,backgroundColor:y.default.brightGrey,paddingVertical:48},refreshControl:t.default.createElement(n.RefreshControl,{refreshing:w,onRefresh:this.handleRefresh})},t.default.createElement(u.default,{source:c.settings,text:(0,h.default)('title_bar')}),O&&t.default.createElement(b.ActivityDotsIndicator,{style:{marginTop:20,alignSelf:'center'}}),!!v&&t.default.createElement(t.default.Fragment,null,t.default.createElement(l.default,{style:{marginHorizontal:24,marginTop:20},message:v}),t.default.createElement(n.View,{style:{alignItems:'center',justifyContent:'center',flexDirection:'row',marginTop:40}},t.default.createElement(n.Image,{source:c.arrowDown,style:{marginRight:14}}),t.default.createElement(p.MediumText,null,(0,h.default)('pull_to_refresh')))),t.default.createElement(f.default,{style:{marginTop:40},consents:s,onToggleChange:this.handleToggleChange}))}}])&&E(w.prototype,_),C&&E(w,C),O})();k.navigationOptions=function(){return{headerTitle:(0,h.default)('screen_title')}};var x=k;e.default=x},1861,[7,10,1294,616,675,1486,1487,1503,962,1862,415,653]);