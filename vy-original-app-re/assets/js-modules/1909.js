__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=E(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),l=r(d[4]),u=r(d[5]),c=r(d[6]),p=r(d[7]),f=E(r(d[8])),v=T(r(d[9])),h=T(r(d[10])),y=T(r(d[11])),P=T(r(d[12])),b=T(r(d[13])),C=T(r(d[14])),w=T(r(d[15])),O=T(r(d[16])),_=T(r(d[17]));function T(t){return t&&t.__esModule?t:{default:t}}function k(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return k=function(){return t},t}function E(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=k();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(o,l,u):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}function N(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function B(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&R(t,n)}function R(t,n){return(R=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var S=(function(b){function T(t){var n,o,s;return N(this,T),o=this,(n=!(s=I(T).call(this,t))||"object"!=typeof s&&"function"!=typeof s?j(o):s)._header=null,n.state={isNewCard:!1},n.handleBackPress=n.handleBackPress.bind(j(n)),n.getReceiptParams=n.getReceiptParams.bind(j(n)),n.navigateToReceipt=n.navigateToReceipt.bind(j(n)),n.navigateToNetsTerminal=n.navigateToNetsTerminal.bind(j(n)),n.handleCaptureFailed=n.handleCaptureFailed.bind(j(n)),n.handleBuyButtonPressed=n.handleBuyButtonPressed.bind(j(n)),n.setTextForCompletionButton=n.setTextForCompletionButton.bind(j(n)),n}var k,E,R;return M(T,t.Component),k=T,(E=[{key:"componentDidMount",value:function(){var t=this.props.navigation.state.params.orderId;this.props.onGetOrder(t);var o=(0,n.findNodeHandle)(this._header);setTimeout(function(){(0,l.setAccessibilityFocus)(o)},500)}},{key:"componentDidUpdate",value:function(t){var n=this.props,o=n.navigation,s=n.order;s&&s!==t.order&&(null==o.state.params.refreshOrderData||o.state.params.refreshOrderData(s))}},{key:"handleBuyButtonPressed",value:function(){var t,n,o,s,l=null==(t=this.props.order)?void 0:null==(n=t.itineraries)?void 0:null==(o=n[0])?void 0:null==(s=o.selectedPriceOption)?void 0:s.amountInOere;this.props.onHandlePayment(l,this.navigateToReceipt,this.navigateToNetsTerminal)}},{key:"navigateToReceipt",value:function(t){var n;this.props.order&&((0,c.trackPaymentFlowSilently)({source:'MOVING_TO_RECEIPT',orderId:null==(n=this.props.order)?void 0:n.id,message:"paymentType: "+(t||'UNKNOWN')}),this.props.navigation.navigate('Receipt',this.getReceiptParams(t)))}},{key:"navigateToNetsTerminal",value:function(t){this.props.order&&this.props.navigation.navigate('NetsTerminal',{url:t,receiptParams:this.getReceiptParams('CARD')})}},{key:"getReceiptParams",value:function(t){var n,o=this,s=this.props.navigation.state.params,l=s.itinerary,u=s.previousStack,c=this.props.order,p=(null==c?void 0:null==(n=c.itineraries)?void 0:n[0])||l;return{tripId:p.tripId,activeTabIndex:0,from:p.from,to:p.to,orderId:c&&c.id,onCaptureFailed:function(n){return o.handleCaptureFailed(n,t)},previousStack:u,origin:null==c?void 0:c.origin}}},{key:"handleCaptureFailed",value:function(t,n){var s,l=(0,u.getMessageFromErrorIfPresent)(t)||(0,_.default)('capture_failed_generic_message'),p=o.NavigationActions.navigate({routeName:'OrderConfirmation',key:this.props.navigation.state.key});this.props.navigation.dispatch(p),this.props.onHandleSetErrorMessage(l);var f=(n||'UNKNOWN')+"_CAPTURE_FAILED";(0,c.trackPaymentFlowSilently)({orderId:null==(s=this.props.order)?void 0:s.id,error:'Error presented to user: '+l,source:f})}},{key:"handleBackPress",value:function(){this.props.navigation.state.params.isNewLogin?this.props.navigation.pop(2):this.props.navigation.goBack(null)}},{key:"setTextForCompletionButton",value:function(t,n){this.props.onHandlePaymentMethodClicked(t),this.setState({isNewCard:n})}},{key:"render",value:function(){var o,l,u,c=this,b=this.props.navigation.state.params,T=b.order,k=b.previousStack,E=this.props,N=E.order,B=E.paymentMethods,I=E.selectedPaymentMethodIndex,j=E.isCreatingOrder,M=E.isInitiatingPayment,R=E.isCheckingVippsPaymentStatus,S=E.isPerformingVippsPayment,F=E.storeNewPaymentCard,x=E.isAdministratingCards,V=E.errorMessage,D=E.onAdministratingCards,A=E.onHandleDeleteCard,H=E.onHandleStoreNewPaymentCardPressed,U=E.handleOnClose,L=E.navigation,W=null!=(o=null==N?void 0:null==(l=N.itineraries)?void 0:l[0])?o:T.itineraries[0],z=W.selectedPriceOption,G=j||x||M||S,K=null==N?void 0:null==(u=N.itineraries)?void 0:u.map(function(t){return t.legs.map(function(t){return t.operator})}).reduce(function(t,n){return t.concat(n)},[]);return t.createElement(s.ScreenView,null,t.createElement(n.View,{ref:function(t){return c._header=t},style:{zIndex:10}},t.createElement(s.HeaderCard,null,t.createElement(h.default,{showVerticalLine:!S,onBackPress:S?void 0:this.handleBackPress,onClose:function(){return U(function(){return k?L.navigate(k):L.goBack(null)})},isLoading:j||R,headerText:(0,_.default)('order_confirmation')}))),t.createElement(n.ScrollView,{style:{backgroundColor:p.colors.brightGrey},contentContainerStyle:{justifyContent:'space-between',paddingBottom:100}},t.createElement(C.default,{priceOption:z,itinerary:W,operators:K}),t.createElement(n.View,{style:{paddingHorizontal:24,marginBottom:6}},'TURNIT'===(null==N?void 0:N.origin)||'TURNIT'===(null==T?void 0:T.origin)?t.createElement(O.default,null):t.createElement(w.default,null)),j?t.createElement(n.View,{style:{marginTop:30,flex:1,alignSelf:'center'}},t.createElement(P.default,null)):t.createElement(v.default,{paymentMethods:B,selectedIndex:I,isAdministratingCards:x,onDeleteCardPressed:A,toggleAdministratingCards:D,storeNewPaymentCard:F,onStoreNewPaymentCardPressed:H,onPaymentMethodPressed:function(t,n){return c.setTextForCompletionButton(t,n)}})),t.createElement(f.default,{animated:!0,style:{marginBottom:24,marginHorizontal:24,position:'absolute',bottom:0},message:V?(0,f.warnMessage)(V):void 0}),t.createElement(y.default,{showShadow:!0,onPress:this.handleBuyButtonPressed,disabled:G,text:(0,_.default)(this.state.isNewCard?'continue_to_add_card':'buy_order')}),t.createElement(s.FadedOverlay,{isVisible:S},t.createElement(n.View,{style:{height:'40%'}},t.createElement(n.View,{style:{padding:12}},t.createElement(s.LargeText,{center:!0},(0,_.default)('performing_vipps_payment'))),t.createElement(n.View,{style:{flex:1,alignItems:'center',justifyContent:'center'}},R&&t.createElement(P.default,null)))))}}])&&B(k.prototype,E),R&&B(k,R),T})();S.navigationOptions=function(t){t.navigation;return{headerTitle:(0,_.default)('order_title_header')}};var F=(0,b.default)(S);e.default=F},1909,[7,10,435,653,979,636,642,414,1487,1726,1715,985,1185,1910,1911,1724,1723,1234]);