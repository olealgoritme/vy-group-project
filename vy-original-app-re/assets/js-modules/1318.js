__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=C();if(s&&s.has(t))return s.get(t);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var c=n?Object.getOwnPropertyDescriptor(t,u):null;c&&(c.get||c.set)?Object.defineProperty(o,u,c):o[u]=t[u]}o.default=t,s&&s.set(t,o);return o})(r(d[0])),s=r(d[1]),o=r(d[2]),n=f(r(d[3])),u=f(r(d[4])),c=r(d[5]),l=f(r(d[6]));function f(t){return t&&t.__esModule?t:{default:t}}function C(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return C=function(){return t},t}function p(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function h(t,s){for(var o=0;o<s.length;o++){var n=s[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t,s){if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),s&&_(t,s)}function _(t,s){return(_=Object.setPrototypeOf||function(t,s){return t.__proto__=s,t})(t,s)}var M=(function(f){function C(t){var s,o,n;return p(this,C),o=this,(s=!(n=b(C).call(this,t))||"object"!=typeof n&&"function"!=typeof n?v(o):n).state={customerCardNumber:t.customerCardNumber,customerCardModalVisible:!1,customerCardErrorMessage:void 0,isValidatingCustomerCard:!1},s.addCustomerCardPassenger=s.addCustomerCardPassenger.bind(v(s)),s.removeCustomerCardPassenger=s.removeCustomerCardPassenger.bind(v(s)),s.toggleCustomerCardModal=s.toggleCustomerCardModal.bind(v(s)),s.validateCustomerCard=s.validateCustomerCard.bind(v(s)),s}var _,M,P;return y(C,t.Component),_=C,(M=[{key:"addCustomerCardPassenger",value:function(t){this.props.addPassenger({type:'ADULT',discount:'CUSTOMER_CARD',extras:[],customerNumber:t})}},{key:"removeCustomerCardPassenger",value:function(){var t=this.props.passengers[this.props.passengers.length-1];if(t)return this.props.removePassenger(function(s){return s.type===t.type&&s.discount===t.discount&&s.customerNumber===t.customerNumber})}},{key:"validateCustomerCard",value:function(){var t=this;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,this.setState({isValidatingCustomerCard:!0,customerCardErrorMessage:void 0}),!this.props.passengers.some(function(s){return s.customerNumber===t.state.customerCardNumber})){s.next=6;break}return this.setState({customerCardErrorMessage:(0,l.default)('customer_card_in_use')}),s.abrupt("return");case 6:return s.next=8,regeneratorRuntime.awrap((0,o.checkValidCustomerCard)(this.state.customerCardNumber));case 8:s.sent?(this.addCustomerCardPassenger(this.state.customerCardNumber),this.toggleCustomerCardModal()):this.setState({customerCardErrorMessage:(0,l.default)('valid_customer_card_not_found')}),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(0),this.setState({customerCardErrorMessage:(0,l.default)('valid_customer_card_not_found')});case 15:return s.prev=15,this.setState({isValidatingCustomerCard:!1}),s.finish(15);case 18:case"end":return s.stop()}},null,this,[[0,12,15,18]])}},{key:"toggleCustomerCardModal",value:function(){this.setState(function(t){return{customerCardModalVisible:!t.customerCardModalVisible,customerCardErrorMessage:void 0}})}},{key:"render",value:function(){var o=this;if(!this.props.category)return null;var f=this.props.passengers.map(function(t){return t.customerNumber});return t.createElement(t.Fragment,null,t.createElement(u.default,{small:!0,categoryName:this.props.category.categoryName,categoryTagline:(0,l.default)('customer_card'),count:this.props.passengers.length,canIncrease:this.props.canIncrease,onIncrease:this.toggleCustomerCardModal,onDecrease:this.removeCustomerCardPassenger}),t.createElement(c.Fade,{isVisible:f.length>0,delay:250},t.createElement(c.MediumText,{mediumGrey:!0,style:{marginTop:6}},(0,l.default)('registered_customer_cards')+': '+f.join(', '))),t.createElement(c.Modal,{isVisible:this.state.customerCardModalVisible,onRequestClose:function(){o.state.isValidatingCustomerCard||(s.Keyboard.dismiss(),o.toggleCustomerCardModal())}},t.createElement(n.default,{value:this.state.customerCardNumber,onValueChange:function(t){return o.setState({customerCardNumber:t})},onSave:this.validateCustomerCard,onClose:this.toggleCustomerCardModal,isValidating:this.state.isValidatingCustomerCard,errorMessage:this.state.customerCardErrorMessage})))}}])&&h(_.prototype,M),P&&h(_,P),C})();e.default=M},1318,[7,10,1319,1320,1323,653,1234]);