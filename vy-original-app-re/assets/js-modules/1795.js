__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=w();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var l=s?Object.getOwnPropertyDescriptor(t,u):null;l&&(l.get||l.set)?Object.defineProperty(o,u,l):o[u]=t[u]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),u=b(r(d[4])),l=b(r(d[5])),c=b(r(d[6])),f=b(r(d[7])),h=b(r(d[8])),y=r(d[9]),p=b(r(d[10])),S=r(d[11]),v=r(d[12]);function b(t){return t&&t.__esModule?t:{default:t}}function w(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return w=function(){return t},t}function _(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function O(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function C(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&E(t,n)}function E(t,n){return(E=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var I=(function(b){function w(t){var n,o,s;return O(this,w),o=this,(n=!(s=L(w).call(this,t))||"object"!=typeof s&&"function"!=typeof s?k(o):s).state={from:void 0,to:void 0,stations:[],currentListItems:{filteredStations:[],directionInFocus:'from'},showStationList:!1,shouldRenderNoResultsMessage:!1},n.setSelectedStation=n.setSelectedStation.bind(k(n)),n.removeSelectedStation=n.removeSelectedStation.bind(k(n)),n.onInputChange=n.onInputChange.bind(k(n)),n.swapStations=n.swapStations.bind(k(n)),n.hideStationList=n.hideStationList.bind(k(n)),n.handleClearQuery=n.handleClearQuery.bind(k(n)),n.handleQueryChange=n.handleQueryChange.bind(k(n)),n.handleAddFavorite=n.handleAddFavorite.bind(k(n)),n}var E,I,Q;return R(w,t.Component),E=w,(I=[{key:"componentDidMount",value:function(){this.getStations()}},{key:"getStations",value:function(){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=[],n.prev=1,n.next=4,regeneratorRuntime.awrap((0,o.getStationsListFromCacheThenRemote)());case 4:t=n.sent,n.next=10;break;case 7:n.prev=7,n.t0=n.catch(1),S.remoteLogger.error(S.sources.FAVORITE_ADD_NEW_FAVORITE,'Something failed while retrieving stations');case 10:return n.prev=10,this.setStations(t.filter(y.isTrainStation)),n.finish(10);case 13:case"end":return n.stop()}},null,this,[[1,7,10,13]])}},{key:"setStations",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length>0||n.Alert.alert((0,c.default)('no_stations_found_alert')),this.setState({stations:t.length>0?(0,s.sortStations)(t):t})}},{key:"setSelectedStation",value:function(t){this.setState(_({},this.state.currentListItems.directionInFocus,t)),this.hideStationList()}},{key:"handleQueryChange",value:function(t,n){P(n,this.state.from,this.state.to)&&this.removeSelectedStation(n),this.onInputChange(t,n)}},{key:"handleClearQuery",value:function(t){this.removeSelectedStation(t)}},{key:"removeSelectedStation",value:function(t){this.setState(_({},t,void 0)),this.hideStationList()}},{key:"swapStations",value:function(){this.setState(function(t){return{from:t.to,to:t.from}})}},{key:"hideStationList",value:function(){this.setState({showStationList:!1,shouldRenderNoResultsMessage:!1})}},{key:"handleAddFavorite",value:function(){this.state.from&&this.state.to&&this.props.onAddFavorite(this.state.from,this.state.to)}},{key:"onInputChange",value:function(t,n){var o=(0,s.sortStationsByQuery)((0,s.filterStationsByQuery)(this.state.stations.filter(function(t){return!0===t.active}),t),t);t.length>0&&o.length>0?this.setState({shouldRenderNoResultsMessage:!1,showStationList:!0,currentListItems:{filteredStations:o,directionInFocus:n}}):t.length>0&&0===o.length?this.setState({showStationList:!1,shouldRenderNoResultsMessage:!0}):this.hideStationList()}},{key:"render",value:function(){var o=this,s=this.state,y=s.from,S=s.to;return t.default.createElement(n.View,{style:f.default.container},t.default.createElement(h.default,{direction:'from',station:this.state.stations,selectedStation:y,onQueryChange:this.handleQueryChange,onClearQuery:this.handleClearQuery,onBlur:this.hideStationList}),t.default.createElement(h.default,{direction:'to',station:this.state.stations,selectedStation:S,onQueryChange:this.handleQueryChange,onClearQuery:this.handleClearQuery,onBlur:this.hideStationList}),t.default.createElement(n.TouchableOpacity,{disabled:!(y&&S),onPress:this.swapStations,accessibilityLabel:(0,c.default)('swap_stations'),accessibilityRole:"button",style:f.default.swapButton},t.default.createElement(n.Image,{source:v.switchVertical,style:f.default.swapIcon})),!!y&&!!S&&t.default.createElement(l.default,{onPress:this.handleAddFavorite},(0,c.default)('save_favorite')),this.state.showStationList&&t.default.createElement(n.FlatList,{contentContainerStyle:{marginTop:-12},data:this.state.currentListItems.filteredStations,keyExtractor:function(t){return t.name},keyboardShouldPersistTaps:"always",renderItem:function(n){var s=n.item;return t.default.createElement(p.default,{item:s,onPress:function(){return o.setSelectedStation(s)}})}}),this.state.shouldRenderNoResultsMessage&&t.default.createElement(u.default,{message:(0,c.default)('no_stations_found_with_query')}))}}])&&C(E.prototype,I),Q&&C(E,Q),w})(),P=function(t,n,o){return'from'===t?!!n:!!o},Q=I;e.default=Q},1795,[7,10,625,1446,1449,986,1636,1796,1797,1331,1798,633,675]);