__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=w();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u=s?Object.getOwnPropertyDescriptor(t,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=t[c]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),c=O(r(d[4])),u=r(d[5]),l=r(d[6]),f=r(d[7]),p=O(r(d[8])),h=r(d[9]),v=O(r(d[10])),b=O(r(d[11])),y=O(r(d[12]));function O(t){return t&&t.__esModule?t:{default:t}}function w(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return w=function(){return t},t}function P(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function S(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?P(Object(o),!0).forEach(function(n){_(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):P(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function _(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function k(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function E(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&U(t,n)}function U(t,n){return(U=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var R=(function(O){function w(t){var n,o,s;return k(this,w),o=this,(n=!(s=j(w).call(this,t))||"object"!=typeof s&&"function"!=typeof s?x(o):s).state={email:'',password:'',loginToken:'',userId:'',message:'',isLoading:!1,createUserSuccess:!0,isRequiredFieldFilled:!1},n.handleBackButtonPress=n.handleBackButtonPress.bind(x(n)),n}var P,U,R;return T(w,t.Component),P=w,(U=[{key:"createUser",value:function(t,o){var s,c=this;return regeneratorRuntime.async(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,regeneratorRuntime.awrap((0,f.createUserIfEmailNotInUse)(t,o));case 3:s=u.sent,this.setState({createUserSuccess:s.success,message:s.message,loginToken:s.loginToken,userId:s.userId},function(){return c.storeLoginState()}),u.next=12;break;case 7:u.prev=7,u.t0=u.catch(0),this.setState({isLoading:!1,createUserSuccess:!1}),console.log('Unable to create profile: '+u.t0),n.Alert.alert('',(0,y.default)('error_alert'));case 12:case"end":return u.stop()}},null,this,[[0,7]])}},{key:"storeLoginState",value:function(){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.createUserSuccess){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,regeneratorRuntime.awrap(p.default.storeLoginState({username:this.state.email,userId:this.state.userId,coldToken:this.state.loginToken,password:this.state.password}));case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),this.handleStoreLoginError(t.t0);case 10:case"end":return t.stop()}},null,this,[[2,7]])}},{key:"handleStoreLoginError",value:function(t){var s=this;this.setState({isLoading:!1,createUserSuccess:!1}),u.remoteLogger.error(u.sources.PROFILE,'Unable to create new profile',{error:t}),console.log('Unable to either fetch profile or save to native: '+t),n.Alert.alert('',(0,y.default)('error_alert_user_created'),[{text:'OK',onPress:function(){s.props.navigation.dispatch(o.NavigationActions.navigate({routeName:'ProfileStack'}))}}],{cancelable:!1})}},{key:"navigateToRegisterPersonal",value:function(){this.props.navigation.navigate('UpdatePersonalInformationScreen',S({},this.props.navigation.state.params,{loginToken:this.state.loginToken,userId:this.state.userId,email:this.state.email})),c.default.NEW_PROFILE_STEP_1_DONE()}},{key:"handleTextChange",value:function(t,n){this.setState(_({},t,n)),'email'!==t||this.state.createUserSuccess||this.setState({createUserSuccess:!0,message:void 0})}},{key:"handleNextButtonClicked",value:function(t,n){return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return this.setState({isLoading:!0}),o.next=3,regeneratorRuntime.awrap(this.createUser(t,n));case 3:this.state.createUserSuccess?this.navigateToRegisterPersonal():this.setState({isLoading:!1});case 4:case"end":return o.stop()}},null,this)}},{key:"toggleNextButton",value:function(){this.setState({isRequiredFieldFilled:(0,h.validateEmail)(this.state.email)&&(0,h.validatePassword)(this.state.password)})}},{key:"handleBackButtonPress",value:function(){this.props.navigation.navigate('TabNavigator'),c.default.NEW_PROFILE_STEP_1_CANCEL()}},{key:"render",value:function(){var o=this,c=this.state,u=c.message,f=c.createUserSuccess,p=c.email,O=c.password,w=c.isRequiredFieldFilled,P=c.isLoading;return t.default.createElement(l.ScreenView,null,t.default.createElement(v.default,{accessibleHeaderTitle:(0,y.default)('accessible_new_profile_title'),screenName:"USER_SCREEN",rightButton:(0,y.default)('close_button'),rightButtonAction:this.handleBackButtonPress}),t.default.createElement(n.View,{style:{flex:1}},t.default.createElement(s.KeyboardAwareScrollView,{contentContainerStyle:{flexGrow:1,padding:18,marginTop:29},showsVerticalScrollIndicator:!1,extraHeight:n.Platform.select({ios:-100,android:150}),keyboardShouldPersistTaps:"handled",enableOnAndroid:!0},t.default.createElement(b.default,{message:u,success:f,email:p,password:O,activeButton:function(){return o.toggleNextButton()},validateEmail:function(t){return(0,h.validateEmail)(t)},validatePassword:function(t){return(0,h.validatePassword)(t)},handleTextChange:function(t,n){return o.handleTextChange(t,n)}}),t.default.createElement(l.PrimaryButton,{children:(0,y.default)('create_user_button'),disabled:!w||P,loading:P,onPress:function(){return o.handleNextButtonClicked(p,O)}}))))}}])&&E(P.prototype,U),R&&E(P,R),w})();e.default=R},1492,[7,10,435,1273,1294,633,653,616,635,1485,1493,1495,1494]);