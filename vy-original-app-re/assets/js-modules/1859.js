__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=_();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(o,l,c):o[l]=t[l]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),l=r(d[4]),c=y(r(d[5])),u=r(d[6]),f=y(r(d[7])),h=r(d[8]),p=r(d[9]),E=r(d[10]),v=r(d[11]);function y(t){return t&&t.__esModule?t:{default:t}}function _(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return _=function(){return t},t}function T(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function b(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function P(t,n,o){return n&&b(t.prototype,n),o&&b(t,o),t}function C(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?w(t):n}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&M(t,n)}function M(t,n){return(M=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var S=(function(s){function l(t){var n;return T(this,l),(n=C(this,k(l).call(this,t))).state={isModalVisible:!1,modalState:'init'},n.handleCollectPress=n.handleCollectPress.bind(w(n)),n.handleCloseModal=n.handleCloseModal.bind(w(n)),n.handleConfirmPress=n.handleConfirmPress.bind(w(n)),n.handleNavigateToTicketsPress=n.handleNavigateToTicketsPress.bind(w(n)),n}return O(l,t.Component),P(l,[{key:"handleCollectPress",value:function(){this.setState({isModalVisible:!0}),c.default.HENT_DAGSBILLETT_CLICKED()}},{key:"handleCloseModal",value:function(){this.setState({isModalVisible:!1,modalState:'init'})}},{key:"handleNavigateToTicketsPress",value:function(){var t=this;this.setState({isModalVisible:!1},function(){t.props.navigation.dispatch(v.StackActions.popToTop()),t.props.navigation.dispatch(v.NavigationActions.navigate({routeName:'TicketsStack'})),t.setState({modalState:'init'})})}},{key:"handleConfirmPress",value:function(t){var n,o,s;return regeneratorRuntime.async(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,c.default.HENT_DAGSBILLETT_CONFIRMED(),l.next=4,regeneratorRuntime.awrap((0,u.authenticateForHotToken)());case 4:if(n=l.sent,o=n.hotToken){l.next=8;break}return l.abrupt("return");case 8:return this.setState({modalState:'loading',modalError:void 0}),l.next=11,regeneratorRuntime.awrap((0,E.createEmployeeTicket)(t,o));case 11:return l.next=13,regeneratorRuntime.awrap((0,h.fetchActiveTickets)());case 13:this.setState({modalState:'success'}),c.default.COLLECT_EMPLOYEE_TICKET(),l.next=22;break;case 17:l.prev=17,l.t0=l.catch(0),(s=l.t0&&l.t0.response&&401===l.t0.response.status)?c.default.COLLECT_EMPLOYEE_TICKET_AUTH_FAIL():c.default.COLLECT_EMPLOYEE_TICKET_FAIL(),this.setState({modalState:'error',modalError:s?(0,f.default)('error_authentication'):(0,p.getMessageFromErrorIfPresent)(l.t0)||void 0});case 22:case"end":return l.stop()}},null,this,[[0,17]])}},{key:"getTitleForState",value:function(){switch(this.state.modalState){case'init':return(0,f.default)('init_header');case'loading':return(0,f.default)('loading_header');case'success':return(0,f.default)('success_header');case'error':return(0,f.default)('error_header')}}},{key:"renderModalState",value:function(){switch(this.state.modalState){case'init':return t.createElement(L,{onConfirm:this.handleConfirmPress});case'loading':return t.createElement(j,null);case'success':return t.createElement(I,{onNavigatePress:this.handleNavigateToTicketsPress});case'error':return t.createElement(V,{error:this.state.modalError,onClose:this.handleCloseModal})}}},{key:"render",value:function(){return t.createElement(n.View,{style:{marginTop:36}},this.props.canCollectTicket&&t.createElement(o.PrimaryButton,{onPress:this.handleCollectPress},(0,f.default)('collect_daily_ticket_button')),t.createElement(o.BottomModal,{onClose:this.handleCloseModal,isVisible:this.state.isModalVisible,headerText:this.getTitleForState()},this.renderModalState()))}}]),l})(),L=(function(l){function c(){var t;return T(this,c),(t=C(this,k(c).call(this))).state={selectedDate:new Date},t}return O(c,t.Component),P(c,[{key:"render",value:function(){var l=this;return t.createElement(n.View,null,t.createElement(s.DatePicker,{date:this.state.selectedDate,onChange:function(t){return l.setState({selectedDate:t})},mode:"date"}),t.createElement(o.PrimaryButton,{onPress:function(){return l.props.onConfirm(l.state.selectedDate)}},(0,f.default)('confirm')))}}]),c})(),j=function(){return t.createElement(n.View,{style:{paddingVertical:60,alignItems:'center'}},t.createElement(o.ActivityDotsIndicator,null))},I=function(s){var c=s.onNavigatePress;return t.createElement(n.View,null,t.createElement(n.View,{style:{alignItems:'center',marginVertical:36}},t.createElement(n.Image,{source:l.largeCheckmark}),t.createElement(o.MediumTextBold,{style:{marginTop:24}},(0,f.default)('success_text'))),t.createElement(o.PrimaryButton,{onPress:c},(0,f.default)('success_goto_tickets')))},V=function(s){var l=s.onClose,c=s.error;return t.createElement(n.View,null,t.createElement(o.MediumTextBold,{style:{marginTop:24,marginBottom:36}},c||(0,f.default)('error_default_text')),t.createElement(o.PrimaryButton,{onPress:l},(0,f.default)('error_button')))},D=(0,v.withNavigation)(S);e.default=D},1859,[7,10,653,1368,675,1294,632,1858,662,636,642,435]);