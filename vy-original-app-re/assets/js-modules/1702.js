__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.navigateToScreen=function(t){return u.NavigationActions.navigate({routeName:j,params:t})},e.default=void 0;var t,n=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=k();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var c=s?Object.getOwnPropertyDescriptor(t,u):null;c&&(c.get||c.set)?Object.defineProperty(o,u,c):o[u]=t[u]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),o=r(d[1]),s=r(d[2]),u=r(d[3]),c=r(d[4]),l=r(d[5]),p=r(d[6]),f=r(d[7]),v=r(d[8]),b=r(d[9]),h=r(d[10]),y=(t=r(d[11]))&&t.__esModule?t:{default:t};function k(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return k=function(){return t},t}function S(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&E(t,n)}function E(t,n){return(E=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var j='SeatReservationBusScreen';function M(t,n,o,s){var u=t.itineraries[0].legs.length>1,c=t.itineraries.some(function(t){var n;return!!(null==(n=t.availableItineraryAddons)?void 0:n.length)});return u?(console.log(o),(0,p.navigateToScreen)({order:t,passengerSummary:s,previousStack:n},o)):c?(0,f.navigateToScreen)({order:t,passengerSummary:s,previousStack:n}):(0,l.navigateToScreen)({origin:'VY_BUS',order:t,previousStack:n})}var P=(function(t){function l(t){var n,o,s;return S(this,l),o=this,(n=!(s=w(l).call(this,t))||"object"!=typeof s&&"function"!=typeof s?O(o):s).webview=null,n.initializeElmSeatChooserApp=n.initializeElmSeatChooserApp.bind(O(n)),n.onMessage=n.onMessage.bind(O(n)),n.goBack=n.goBack.bind(O(n)),n}var p,f,k;return B(l,n.Component),p=l,(f=[{key:"initializeElmSeatChooserApp",value:function(){var t,n,s,u,c,l,p,f=this;return regeneratorRuntime.async(function(k){for(;;)switch(k.prev=k.next){case 0:if(t=this.props.navigation.state.params,n=t.order,s=t.legNumbers,u=t.passengerSummary,n.turnitShoppingBasketId){k.next=3;break}return k.abrupt("return",'');case 3:return k.prev=3,k.next=6,regeneratorRuntime.awrap((0,h.getSharedHeaders)());case 6:c=k.sent,l=s||n.itineraries[0].legs.filter(function(t){return t.availableAccommodations.some(function(t){return t.seatMapAvailable})}).map(function(t){return n.itineraries[0].legs.indexOf(t)+1}),p={orderId:n.id,shoppingBasketId:n.turnitShoppingBasketId,legNumbers:l,language:'en'===(0,b.getLanguage)()?'english':'norwegian',userId:c['X-user-id']||null,userSessionTokenCold:c.loginToken||null,userSessionTokenHot:null,passengersString:u},this.webview&&this.webview.injectJavaScript("\n                    (function() {\n                        document.dispatchEvent(new MessageEvent(\"message\",{data:'"+JSON.stringify(p)+"'}));\n                    })();\n\n                    (function() {\n                        window.postMessage = function(data) {\n                          window.ReactNativeWebView.postMessage(data);\n                        };\n                    \n                    })();\n                    "),k.next=15;break;case 12:k.prev=12,k.t0=k.catch(3),o.Alert.alert((0,y.default)('order_or_payment_failed_alert_title'),(0,v.getMessageFromErrorIfPresent)(k.t0)||(0,y.default)('get_order_failed_generic_message'),[{text:'Ok',onPress:function(){return f.goBack(!0)}}]);case 15:case"end":return k.stop()}},null,this,[[3,12]])}},{key:"onMessage",value:function(t){var n=this;try{var s=JSON.parse(t.nativeEvent.data),u=this.props.navigation,c=u.state.params,l=c.legNumbers,p=c.order,f=c.previousStack,v=c.passengerSummary;switch(s.type){case'SUCCESS':u.dispatch(M(s.order||p,f,!!l,v));break;case'BACK':this.goBack(!1);break;case'CLOSE':this.goBack(!0);break;case'ERROR':o.Alert.alert((0,y.default)('order_or_payment_failed_alert_title'),s.message||(0,y.default)('initiate_order_failed_generic_message'),[{text:'Ok',onPress:function(){return n.goBack(!1)}}]);break;default:this.goBack(!1)}}catch(t){console.log(t)}}},{key:"goBack",value:function(t){var n=this.props.navigation;if(t){var o=n.getParam('previousStack');o?n.navigate(o):n.goBack(null)}else n.goBack(null)}},{key:"render",value:function(){var t=this,o='en'===(0,b.getLanguage)()?c.seatAppIntegrationBaseUrlEn:c.seatAppIntegrationBaseUrlNo;return n.createElement(u.SafeAreaView,{forceInset:{top:'always',bottom:'always'},style:{flex:1}},n.createElement(s.WebView,{source:{uri:o},ref:function(n){return t.webview=n},onLoad:this.initializeElmSeatChooserApp,onMessage:this.onMessage,bounces:!1}))}}])&&_(p.prototype,f),k&&_(p,k),l})();e.default=P},1702,[7,10,606,435,1703,1704,1738,1739,636,672,632,1234]);