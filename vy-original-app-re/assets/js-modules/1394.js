__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=b();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var u=s?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(o,l,u):o[l]=t[l]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=h(r(d[1])),o=r(d[2]),s=h(r(d[3])),l=h(r(d[4])),u=r(d[5]),c=h(r(d[6])),f=h(r(d[7])),p=h(r(d[8]));function h(t){return t&&t.__esModule?t:{default:t}}function b(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return b=function(){return t},t}function y(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function v(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&M(t,n)}function M(t,n){return(M=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var B=(function(h){function b(t){var n,o,s;return y(this,b),o=this,(n=!(s=C(b).call(this,t))||"object"!=typeof s&&"function"!=typeof s?O(o):s).state={isInformationModalVisible:!1,isOnboardingBybilCollapsed:!1,location:void 0,selectedCar:void 0,infoMessage:void 0,cars:[],hotspots:[]},n.getCars=n.getCars.bind(O(n)),n.openDinBybilApp=n.openDinBybilApp.bind(O(n)),n.toggleInformationModal=n.toggleInformationModal.bind(O(n)),n.handleCollapseOnboardingBybil=n.handleCollapseOnboardingBybil.bind(O(n)),n.handleLocationUpdate=n.handleLocationUpdate.bind(O(n)),n.handleSelectCar=n.handleSelectCar.bind(O(n)),n}var M,B,I;return _(b,t.Component),M=b,(B=[{key:"componentDidUpdate",value:function(t){var n=this,o=t.isVisible&&!this.props.isVisible,s=!t.isVisible&&this.props.isVisible,l='authorized'===t.locationAuthorization,u='authorized'===this.props.locationAuthorization,c=l&&!u;!l&&u&&this.setState({infoMessage:void 0}),(c||s&&!u)&&setTimeout(function(){n.setState({infoMessage:(0,p.default)('no_location_message')})},1e3),o&&this.setState({selectedCar:void 0,cars:[],hotspots:[],location:void 0,infoMessage:void 0})}},{key:"getCars",value:function(t){var s,l,u,c,f,h;return regeneratorRuntime.async(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,this.setState({infoMessage:void 0}),b.next=4,regeneratorRuntime.awrap((0,o.fetchAvailableBybilCars)(t.latitude,t.longitude));case 4:s=b.sent,l=s.vehicles,u=void 0===l?[]:l,c=s.hotspots,f=void 0===c?[]:c,u.length||this.setState({infoMessage:(0,p.default)('no_cars_available')}),h=u.sort(function(o,s){return(0,n.default)(o.location,t)-(0,n.default)(s.location,t)}),this.setState({cars:h,hotspots:f}),b.next=17;break;case 14:b.prev=14,b.t0=b.catch(0),this.setState({infoMessage:(0,p.default)('failed_to_load_cars')});case 17:case"end":return b.stop()}},null,this,[[0,14]])}},{key:"openDinBybilApp",value:function(){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap((0,u.canOpenDinBybil)());case 2:if(t=n.sent,s.default.BYBIL_OPEN_APP_LINK({installed:t}),t){n.next=7;break}return(0,u.showInstallAppAlert)(),n.abrupt("return");case 7:(0,u.openDinBybil)();case 8:case"end":return n.stop()}})}},{key:"toggleInformationModal",value:function(){this.setState(function(t){return t.isInformationModalVisible||s.default.OPEN_BYBIL_INFORMATION_MODAL(),{isInformationModalVisible:!t.isInformationModalVisible}})}},{key:"handleCollapseOnboardingBybil",value:function(){this.setState({isOnboardingBybilCollapsed:!0})}},{key:"handleLocationUpdate",value:function(t){var n=this;this.setState(function(o){return o.location||n.getCars(t),{location:t}})}},{key:"handleSelectCar",value:function(t){this.setState(function(n){return n.selectedCar||s.default.BYBIL_SELECTED_CAR_IN_MAP(),{selectedCar:t,isOnboardingBybilCollapsed:!0}})}},{key:"render",value:function(){return t.default.createElement(l.default,{isVisible:this.props.isVisible,onClose:this.props.onClose},t.default.createElement(c.default,{onClose:this.props.onClose,isOnboardingBybilCollapsed:this.state.isOnboardingBybilCollapsed,handleCollapseOnboardingBybil:this.handleCollapseOnboardingBybil,location:this.state.location,locationAuthorization:this.props.locationAuthorization,onLocationUpdate:this.handleLocationUpdate,cars:this.state.cars,hotspots:this.state.hotspots,onSelectCar:this.handleSelectCar,selectedCar:this.state.selectedCar,infoMessage:this.state.infoMessage,getCars:this.getCars,toggleInformationModal:this.toggleInformationModal,openDinBybilApp:this.openDinBybilApp}),t.default.createElement(f.default,{isInformationModalVisible:this.state.isInformationModalVisible,toggleInformationModal:this.toggleInformationModal}))}}])&&v(M.prototype,B),I&&v(M,I),b})();e.default=B},1394,[7,1395,625,1294,1241,1396,1398,1435,1397]);