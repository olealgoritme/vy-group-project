__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=O();if(n&&n.has(t))return n.get(t);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var s=c?Object.getOwnPropertyDescriptor(t,u):null;s&&(s.get||s.set)?Object.defineProperty(o,u,s):o[u]=t[u]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),c=r(d[3]),u=r(d[4]),s=r(d[5]),f=r(d[6]),p=r(d[7]),l=S(r(d[8])),v=S(r(d[9])),h=S(r(d[10])),y=S(r(d[11]));function S(t){return t&&t.__esModule?t:{default:t}}function O(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return O=function(){return t},t}function b(t){return k(t)||w(t)||_()}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function w(t){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function k(t){if(Array.isArray(t)){for(var n=0,o=new Array(t.length);n<t.length;n++)o[n]=t[n];return o}}function P(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function C(t,n){for(var o=0;o<n.length;o++){var c=n[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&R(t,n)}function R(t,n){return(R=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var D=(function(o){function S(t){var n,o,c;return P(this,S),o=this,(n=!(c=T(S).call(this,t))||"object"!=typeof c&&"function"!=typeof c?j(o):c).state={isCreatingOrder:!1,toStop:void 0,fromStop:void 0,currentProduct:void 0},n.changeStop=n.changeStop.bind(j(n)),n.flipDirection=n.flipDirection.bind(j(n)),n.navigateToOrderConfirmation=n.navigateToOrderConfirmation.bind(j(n)),n}var O,_,w;return E(S,t.Component),O=S,(_=[{key:"changeStop",value:function(t,n){var o,c,u;this.setState((o={},u=n,(c='FROM'===t?'fromStop':'toStop')in o?Object.defineProperty(o,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[c]=u,o))}},{key:"flipDirection",value:function(){this.state.fromStop&&this.state.toStop&&this.setState(function(t){var n=t.toStop;return n&&n.showChooseStopString&&(n.isCurrentLocation=!0,n.showChooseStopString=!1),{fromStop:n,toStop:t.fromStop}})}},{key:"setRecentSearchLocalOperatorStop",value:function(){var t=this.props.navigation.state.params.operator,n=this.state,o=n.fromStop,c=n.toStop;if(t&&o&&c){var u=[].concat(b('STOP'===c.type?[c]:[]),b('STOP'===o.type?[o]:[]));u.length&&(0,s.setRecentSearchLocalOperatorStop)(t,u)}}},{key:"navigateToOrderConfirmation",value:function(t,o){var c,s,p;return regeneratorRuntime.async(function(v){for(;;)switch(v.prev=v.next){case 0:if(t){v.next=2;break}return v.abrupt("return");case 2:return this.setRecentSearchLocalOperatorStop(),v.prev=3,this.setState({isCreatingOrder:!0}),v.next=7,regeneratorRuntime.awrap((0,u.createOrderPeriodTicket)(t.id));case 7:return c=v.sent,s=c.id,v.next=11,regeneratorRuntime.awrap((0,u.getOrder)(s));case 11:p=v.sent,this.props.navigation.navigate('PeriodTicketOrderConfirmation',{orderToSave:o,orderId:s,order:p,previousStack:{routeName:this.props.navigation.state.routeName,key:this.props.navigation.state.key,firstRouteName:'NewTicketScreen'}}),v.next=18;break;case 15:v.prev=15,v.t0=v.catch(3),n.Alert.alert((0,l.default)('order_or_payment_failed_alert_title'),(0,f.getMessageFromErrorIfPresent)(v.t0)||(0,l.default)('initiate_order_failed_generic_message'));case 18:return v.prev=18,this.setState({isCreatingOrder:!1}),v.finish(18);case 21:case"end":return v.stop()}},null,this,[[3,15,18,21]])}},{key:"render",value:function(){var n=this.props.navigation.state.params,o=n.operator,u=n.ticketType,s=this.state,f=s.fromStop,l=s.toStop,S='SINGLE_TICKET'===u?v.default:'PERIOD_TICKET'===u?h.default:y.default;return t.createElement(c.ScreenView,{style:{backgroundColor:p.colors.brightGrey}},t.createElement(S,{isCreatingOrder:this.state.isCreatingOrder,operator:o,toStop:l,fromStop:f,changeStop:this.changeStop,flipDirection:this.flipDirection,navigateToOrderConfirmation:this.navigateToOrderConfirmation}))}}])&&C(O.prototype,_),w&&C(O,w),S})();D.navigationOptions=function(n){var c,u=n.navigation,s=n.navigationOptions,f=u.getParam('ticketType'),p=u.getParam('goBackParams');return{headerTitle:(0,l.default)(null!=(c=f.toLowerCase())?c:'single_ticket'),headerLeft:t.createElement(o.HeaderBackButton,{tintColor:s.headerTintColor,onPress:function(){return p?u.navigate(p):u.goBack(null)}})}};var I=D;e.default=I},1517,[7,10,577,653,642,645,636,414,1472,1518,1531,1534]);