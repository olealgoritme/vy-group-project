__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=y();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u=s?Object.getOwnPropertyDescriptor(t,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=t[c]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=v(r(d[3])),c=r(d[4]),u=r(d[5]),f=r(d[6]),p=r(d[7]),l=r(d[8]),O=v(r(d[9])),h=v(r(d[10]));function v(t){return t&&t.__esModule?t:{default:t}}function y(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return y=function(){return t},t}function b(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function w(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&x(t,n)}function x(t,n){return(x=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var T=(function(o){function v(t){var n,o,s;return b(this,v),o=this,(n=!(s=_(v).call(this,t))||"object"!=typeof s&&"function"!=typeof s?R(o):s).state={recentOrders:[],isCreatingRecentOrder:!1,currentOrderIndex:void 0},n.navigateToOrderConfirmation=n.navigateToOrderConfirmation.bind(R(n)),n}var y,x,T;return k(v,t.Component),y=v,(x=[{key:"componentDidMount",value:function(){this.getRecentOrders()}},{key:"getRecentOrders",value:function(){var t,n;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return this.setState({recentOrders:[]}),t='KOLUMBUS'===this.props.operator?2:3,o.next=4,regeneratorRuntime.awrap((0,p.getRecentOrders)(this.props.operator,t));case 4:(n=o.sent).length&&this.setState({recentOrders:n});case 6:case"end":return o.stop()}},null,this)}},{key:"navigateToOrderConfirmation",value:function(t){var o,s,c,u;return regeneratorRuntime.async(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,this.setState({isCreatingRecentOrder:!0}),O.next=4,regeneratorRuntime.awrap(this.getProductId(t));case 4:return o=O.sent,O.next=7,regeneratorRuntime.awrap((0,f.createOrderPeriodTicket)(o));case 7:return s=O.sent,c=s.id,O.next=11,regeneratorRuntime.awrap((0,f.getOrder)(c));case 11:u=O.sent,this.props.navigation.navigate('PeriodTicketOrderConfirmation',{orderId:c,order:u,previousStack:{routeName:this.props.navigation.state.routeName,key:this.props.navigation.state.key,firstRouteName:'NewTicketScreen'}}),O.next=21;break;case 15:return O.prev=15,O.t0=O.catch(0),O.next=19,regeneratorRuntime.awrap((0,p.deleteOrderRecentOrders)(t,this.props.operator));case 19:this.getRecentOrders(),n.Alert.alert((0,h.default)('order_or_payment_failed_alert_title'),(0,l.getMessageFromErrorIfPresent)(O.t0)||(0,h.default)('initiate_order_failed_generic_message'));case 21:return O.prev=21,this.setState({isCreatingRecentOrder:!1}),O.finish(21);case 24:case"end":return O.stop()}},null,this,[[0,15,21,24]])}},{key:"getProductId",value:function(t){var n,o,s,c,f,p,l;return regeneratorRuntime.async(function(O){for(;;)switch(O.prev=O.next){case 0:if(n=t.ticketType,o=t.from,s=t.to,c=t.passengers,f=t.duration,p=this.props.operator,n&&o&&s&&c.length){O.next=4;break}throw new Error;case 4:if('PERIOD_TICKET'!==n){O.next=12;break}if(f){O.next=7;break}throw new Error;case 7:return O.next=9,regeneratorRuntime.awrap((0,u.recentOrderPeriodTicket)(t,p));case 9:l=O.sent,O.next=19;break;case 12:if('SINGLE_TICKET'!==n||'RUTER'!==p){O.next=18;break}return O.next=15,regeneratorRuntime.awrap((0,u.recentOrderSingleTicket)(t,p));case 15:l=O.sent,O.next=19;break;case 18:throw new Error;case 19:if(l){O.next=21;break}throw new Error;case 21:return O.abrupt("return",l);case 22:case"end":return O.stop()}},null,this)}},{key:"render",value:function(){var n=this,o=this.state,u=o.isCreatingRecentOrder,f=o.recentOrders,p=o.currentOrderIndex;return t.createElement(c.Fade,{isVisible:!!f.length,style:{marginTop:18,width:'100%'}},t.createElement(c.MediumText,{style:{marginBottom:12}},(0,h.default)('recent_orders')),f.map(function(o,c){return t.createElement(O.default,{key:c,isDisabled:u,isLoading:u&&c===p,order:o,onPress:function(){n.navigateToOrderConfirmation(o),n.setState({currentOrderIndex:c}),s.default.RUTER_CONTINUE_TO_PAYMENT({from:'Recent Purchase',operator:n.props.operator})}})}))}}])&&w(y.prototype,x),T&&w(y,T),v})(),P=(0,o.withNavigation)(T);e.default=P},1513,[7,10,435,1294,653,641,642,640,636,1514,1472]);