__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var o=y();if(o&&o.has(t))return o.get(t);var n={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var l=u?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(n,c,l):n[c]=t[c]}n.default=t,o&&o.set(t,n);return n})(r(d[0])),o=r(d[1]),n=r(d[2]),u=r(d[3]),c=r(d[4]),l=r(d[5]),s=h(r(d[6])),p=h(r(d[7])),f=h(r(d[8])),k=h(r(d[9])),C=h(r(d[10]));function h(t){return t&&t.__esModule?t:{default:t}}function y(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return y=function(){return t},t}function P(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function b(t,o){for(var n=0;n<o.length;n++){var u=o[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(t,u.key,u)}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(o&&o.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),o&&M(t,o)}function M(t,o){return(M=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t})(t,o)}var w=(function(h){function y(t){var o,n,u;return P(this,y),n=this,(o=!(u=v(y).call(this,t))||"object"!=typeof u&&"function"!=typeof u?_(n):u).state=o.initialState,o.openPickupCodeModal=o.openPickupCodeModal.bind(_(o)),o.closePickupCodeModal=o.closePickupCodeModal.bind(_(o)),o.claimPickupCode=o.claimPickupCode.bind(_(o)),o}var M,w,E;return O(y,t.Component),M=y,(w=[{key:"clearCacheAndFetchActiveTickets",value:function(){var t=this;(0,n.emptyTicketDatabaseAndRefetchTickets)().then(function(){return t.props.onPickupCodeClaimSuccess()})}},{key:"openPickupCodeModal",value:function(){this.setState(this.initialState),this.setState({pickupCodeModalOpen:!0})}},{key:"closePickupCodeModal",value:function(){o.Keyboard.dismiss(),this.setState({pickupCodeModalOpen:!1})}},{key:"setPickupCode",value:function(t){this.setState({pickupCode:t})}},{key:"setErrorText",value:function(t){this.setState({pickupCodeError:t})}},{key:"claimPickupCode",value:function(){var t=this;this.setState({pickupCodeError:null,waitingForResponse:!0},function(){(0,l.claimPickupCode)(t.state.pickupCode).then(function(){return t.successfulPickupCodeClaim()}).catch(function(o){return t.failedPickupCodeClaim(o)}).done(function(){return t.claimPickupCodeRequestDone()})})}},{key:"successfulPickupCodeClaim",value:function(){o.Keyboard.dismiss(),this.clearCacheAndFetchActiveTickets(),this.setState({ticketsAdded:!0})}},{key:"failedPickupCodeClaim",value:function(t){this.setErrorText((0,u.getMessageFromErrorIfPresent)(t)||(0,f.default)('pickup_code_modal_generic_error'))}},{key:"claimPickupCodeRequestDone",value:function(){this.setState({waitingForResponse:!1})}},{key:"render",value:function(){var n=this;return t.default.createElement(o.View,{style:this.props.style},t.default.createElement(c.FriendlyButton,{onPress:this.openPickupCodeModal,children:(0,f.default)('got_pickup_code_button'),accessibilityLabel:(0,f.default)('got_pickup_code_button'),size:"small"}),t.default.createElement(p.default,{isVisible:this.state.pickupCodeModalOpen,onRequestClose:this.closePickupCodeModal},t.default.createElement(s.default,{onClose:this.closePickupCodeModal},!this.state.ticketsAdded&&(0,f.default)('pickup_code_modal_title')),this.state.ticketsAdded?t.default.createElement(C.default,null):t.default.createElement(k.default,{setPickupCode:function(t){n.setPickupCode(t)},claimPickupCode:this.claimPickupCode,waitingForResponse:this.state.waitingForResponse,pickupCodeError:this.state.pickupCodeError})))}},{key:"initialState",get:function(){return{pickupCodeModalOpen:!1,pickupCode:'',pickupCodeError:null,waitingForResponse:!1,ticketsAdded:!1}}}])&&b(M.prototype,w),E&&b(M,E),y})();e.default=w},1633,[7,10,1634,636,658,662,1269,1271,673,1637,1640]);