__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=y();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u=s?Object.getOwnPropertyDescriptor(t,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=t[c]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),c=v(r(d[4])),u=v(r(d[5])),f=v(r(d[6])),l=v(r(d[7])),p=v(r(d[8])),h=r(d[9]);function v(t){return t&&t.__esModule?t:{default:t}}function y(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return y=function(){return t},t}function b(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function O(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?b(Object(o),!0).forEach(function(n){w(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):b(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function w(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function P(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function R(t,n){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var o=[],s=!0,c=!1,u=void 0;try{for(var f,l=t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();!(s=(f=l.next()).done)&&(o.push(f.value),!n||o.length!==n);s=!0);}catch(t){c=!0,u=t}finally{try{s||null==l.return||l.return()}finally{if(c)throw u}}return o}}function j(t){if(Array.isArray(t))return t}function E(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function F(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&L(t,n)}function L(t,n){return(L=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var k=(function(v){function y(){var t,n,o,s;E(this,y);for(var c=arguments.length,u=new Array(c),f=0;f<c;f++)u[f]=arguments[f];return o=this,(n=!(s=(t=S(y)).call.apply(t,[this].concat(u)))||"object"!=typeof s&&"function"!=typeof s?F(o):s).state={isFetching:!0,isFetchingLater:!1,failedFetchingLater:!1,isRefreshing:!1,itineraries:null},n}var b,w,L;return I(y,t.Component),b=y,(w=[{key:"componentDidMount",value:function(){this.fetchItineraries(this.props.navigation.state.params.selectedTime)}},{key:"fetchItineraries",value:function(t){var n,c,u,f,l,p,v,y,b=this;return regeneratorRuntime.async(function(O){for(;;)switch(O.prev=O.next){case 0:return n=this.props.navigation.state.params,c=n.from.name,u=n.to.name,f=t.format(h.SERVER_DATE_FORMAT),O.prev=2,O.next=5,regeneratorRuntime.awrap((0,o.getPreferredPassengerCategory)());case 5:return l=O.sent,E=1,p=j(w=l)||R(w,E)||P(),v=p[0],O.next=10,regeneratorRuntime.awrap((0,s.fetchItinerariesForStationPair)(c,u,f,[v||o.DEFAULT_PASSENGER]));case 10:y=O.sent,this.setState({isFetching:!1,isRefreshing:!1,itineraries:y}),O.next=17;break;case 14:O.prev=14,O.t0=O.catch(2),this.setState({isFetching:!1,isRefreshing:!1},function(){return b.showItineraryRetrievalError()});case 17:case"end":return O.stop()}var w,E},null,this,[[2,14]])}},{key:"fetchLaterItineraries",value:function(){var t,n,o,c,u;return regeneratorRuntime.async(function(f){for(;;)switch(f.prev=f.next){case 0:if(t=this.state,n=t.itineraries,o=t.isFetchingLater,!n||o){f.next=14;break}return this.setState({isFetchingLater:!0}),f.prev=3,f.next=6,regeneratorRuntime.awrap((0,s.fetchLaterItineraries)(n.resultSetId));case 6:c=f.sent,u=n.itineraries.concat(c.itineraries),this.setState({isFetchingLater:!1,itineraries:O({},c,{itineraries:u})}),f.next=14;break;case 11:f.prev=11,f.t0=f.catch(3),this.setState({isFetchingLater:!1,failedFetchingLater:!0});case 14:case"end":return f.stop()}},null,this,[[3,11]])}},{key:"showItineraryRetrievalError",value:function(){var t=this;n.Alert.alert((0,p.default)('itinerary_retrieval_alert_title'),(0,p.default)('itinerary_retrieval_alert_message'),[{text:'Ok',onPress:function(){return t.props.navigation.goBack(null)}}])}},{key:"onDeparturePressed",value:function(t){u.default.DEPARTURE_IN_FAVORITESDEPARTURES_CLICKED({from:t.legs[0].from,to:t.legs[t.legs.length-1].to}),this.props.navigation.navigate('DepartureDetailsScreen',{isBusDeparture:!1,itinerary:t,passengerCategories:this.state.itineraries.passengerInformation.availableCategories,passengers:this.state.itineraries.passengerInformation.passengers,previousStack:{routeName:this.props.navigation.state.routeName,key:this.props.navigation.state.key,firstRouteName:'Favorites'}})}},{key:"handleEndReached",value:function(){var t=this.state,n=t.failedFetchingLater,o=(t.itineraries||{}).hasLaterItineraries;void 0!==o&&o&&!n&&this.fetchLaterItineraries()}},{key:"handleOnRefresh",value:function(){var t=this;this.setState({isRefreshing:!0,failedFetchingLater:!1},function(){var n=t.props.navigation.state.params.selectedTime;t.fetchItineraries(n)})}},{key:"render",value:function(){var n=this,o=this.state,s=o.isFetching,u=o.isRefreshing,p=o.isFetchingLater,v=o.failedFetchingLater,y=o.itineraries||{},b=y.hasEarlierItineraries,O=void 0!==b&&b,w=y.hasLaterItineraries,P=void 0!==w&&w,R=y.itineraries,j=void 0===R?[]:R;return t.default.createElement(c.default,null,s?t.default.createElement(f.default,{style:{marginTop:50,backgroundColor:h.colors.brightGrey}}):t.default.createElement(l.default,{data:j,onEndReached:function(){return n.handleEndReached()},onRefresh:function(){return n.handleOnRefresh()},isRefreshing:s||u,isFetching:s,isFetchingLater:p,hasFailedFetchingLater:v,onFooterTapped:function(){n.fetchLaterItineraries()},onDeparturePressed:function(t){return n.onDeparturePressed(t)},hasLaterItineraries:P,hasEarlierItineraries:O}))}}])&&_(b.prototype,w),L&&_(b,L),y})();k.navigationOptions=function(t){var n=t.navigation.state.params;return{headerTitle:n&&n.from.name+" - "+n.to.name}};var D=k;e.default=D},1808,[7,10,612,642,1266,1294,1298,1809,1636,414]);