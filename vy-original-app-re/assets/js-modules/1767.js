__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.statuses=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=E();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var l=s?Object.getOwnPropertyDescriptor(t,u):null;l&&(l.get||l.set)?Object.defineProperty(o,u,l):o[u]=t[u]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=O(r(d[3])),u=r(d[4]),l=O(r(d[5])),c=O(r(d[6])),f=O(r(d[7])),p=r(d[8]),v=O(r(d[9])),y=O(r(d[10])),b=O(r(d[11])),h=O(r(d[12])),S=O(r(d[13]));function O(t){return t&&t.__esModule?t:{default:t}}function E(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return E=function(){return t},t}function R(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function w(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?R(Object(o),!0).forEach(function(n){_(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):R(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function _(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function T(t,n){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var o=[],s=!0,u=!1,l=void 0;try{for(var c,f=t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();!(s=(c=f.next()).done)&&(o.push(c.value),!n||o.length!==n);s=!0);}catch(t){u=!0,l=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}return o}}function C(t){if(Array.isArray(t))return t}function P(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function k(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&V(t,n)}function V(t,n){return(V=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var D={seatChooserVisible:'seatChooserVisible',isReservingSeat:'isReservingSeat',seatReservedSuccessfully:'seatReservedSuccessfully',reservingSeatFailed:'reservingSeatFailed',showingSeatChooserFailed:'showingSeatChooserFailed'};function N(t,n){var o=v.default.duration((0,v.default)(t.departureScheduled).diff((0,v.default)())),u=Math.floor(o.asHours())+"h "+o.minutes()+"m";if(n){var l=w({},n,{timeUntilTrip:u});t.hasReservation?s.default.USER_RESERVED_MULTI_LEGS_FOR_PERIODTKT({seatReservationTrackObject:JSON.stringify(l)}):s.default.RESERVED_SEAT_FOR_PERIODTICKET({seatReservationTrackObject:JSON.stringify(l)})}else s.default.USER_GOT_AUTO_SEAT_FOR_PERIODTICKET({timeUntilTrip:JSON.stringify({timeUntilTrip:u})})}e.statuses=D;var M=(function(v){function O(t){var n,o,s;return P(this,O),o=this,(n=!(s=A(O).call(this,t))||"object"!=typeof s&&"function"!=typeof s?F(o):s).state={status:D.seatChooserVisible},n.onError=n.onError.bind(F(n)),n.goBack=n.goBack.bind(F(n)),n.handleReserveSeat=n.handleReserveSeat.bind(F(n)),n.reserveSeatAutomatically=n.reserveSeatAutomatically.bind(F(n)),n}var E,R,w;return I(O,t.Component),E=O,(R=[{key:"handleReserveSeat",value:function(t){var n,o,s=(o=1,C(n=t)||T(n,o)||j())[0];s&&this.reserveSeat({carNumber:s.carNumber,seatNumber:s.seatNumber})}},{key:"reserveSeatAutomatically",value:function(){this.reserveSeat()}},{key:"reserveSeat",value:function(t){var n,o,s,l,c,f;return regeneratorRuntime.async(function(v){for(;;)switch(v.prev=v.next){case 0:return n=this.props.navigation.state.params,o=n.leg,s=n.itinerary,l=n.ticket,c=n.onSeatReserved,f=n.direction,this.setState({status:D.isReservingSeat}),v.prev=2,v.next=5,regeneratorRuntime.awrap((0,p.reserveSeat)('to'===f?l.stationFromCode:l.stationToCode,'to'===f?l.stationToCode:l.stationFromCode,l.ticketId,o.trainJourney.identifier,s.departureScheduled,t));case 5:v.next=12;break;case 7:return v.prev=7,v.t0=v.catch(2),this.setState({status:D.reservingSeatFailed}),u.remoteLogger.error(u.sources.GENERAL,'Reserving seat for periodticket failed',{error:v.t0}),v.abrupt("return");case 12:return v.next=14,regeneratorRuntime.awrap(c());case 14:this.setState({status:D.seatReservedSuccessfully}),setTimeout(this.props.navigation.pop,1200),N(s,t);case 17:case"end":return v.stop()}},null,this,[[2,7]])}},{key:"goBack",value:function(){this.props.navigation.pop(),s.default.OPEN_SEATMAP_WITHOUT_RESERVING_SEAT()}},{key:"onError",value:function(){this.setState({status:D.showingSeatChooserFailed})}},{key:"render",value:function(){var s=this.props.navigation.state.params,u=s.leg,p=s.ticket,v=this.state.status;return t.default.createElement(n.View,{style:y.default.seatChooserContainer()},t.default.createElement(o.SafeAreaView,{forceInset:{top:'always'},style:{backgroundColor:S.default.white}},t.default.createElement(f.default,{leg:u,ticket:p,onClose:this.props.navigation.state.params.onClose,goBack:this.goBack,onReserveSeatAutomatically:this.reserveSeatAutomatically})),v===D.seatChooserVisible&&t.default.createElement(o.SafeAreaView,{style:{flex:1}},t.default.createElement(l.default,{leg:u,onError:this.onError,onReserveSeat:this.handleReserveSeat,accommodationConfiguration:{specificationValue:'SEAT_SELECTION',numberOfTravellers:1}})),v===D.showingSeatChooserFailed&&t.default.createElement(h.default,{onReserveSeatAutomatically:this.reserveSeatAutomatically,navigation:this.props.navigation}),t.default.createElement(c.default,{isVisible:v===D.isReservingSeat||v===D.seatReservedSuccessfully||v===D.reservingSeatFailed,onClose:function(){}},t.default.createElement(b.default,{status:v,onClose:this.props.navigation.pop})))}}])&&k(E.prototype,R),w&&k(E,w),O})();e.default=M},1767,[7,10,435,1294,633,1768,1241,1770,1480,628,1681,1772,1774,415]);