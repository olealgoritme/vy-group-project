__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.loadAppState=function(){var t,n,s,o;return regeneratorRuntime.async(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,regeneratorRuntime.awrap(p.default.getNativeUserId());case 2:return t=!!l.sent,l.next=5,regeneratorRuntime.awrap(p.default.hasLoginToken());case 5:return n=l.sent,s=n&&t,l.next=9,regeneratorRuntime.awrap((0,u.getUserStateFromAsyncStorage)());case 9:if(o=l.sent,'active'!==y&&R.remoteLogger.warn(R.sources.STARTUP,'React native startup procedure started in background or inactive',{asyncStorageUserId:o&&o.userId,hasNativeLoginToken:n,hasNativeUserId:t,appState:y}),s||!o){l.next=21;break}if('active'!==y){l.next=17;break}return l.next=15,regeneratorRuntime.awrap(p.default.logout());case 15:l.next=19;break;case 17:(0,c.setUserId)(o.userId),(0,f.setUserProfileState)(o);case 19:return R.remoteLogger.error(R.sources.STARTUP,'User has data in async storage, but lacking in native layer',{asyncStorageUserId:o.userId,hasNativeLoginToken:n,hasNativeUserId:t,appState:y}),l.abrupt("return");case 21:if(!o){l.next=27;break}(0,c.setUserId)(o.userId),(0,f.setUserProfileState)(o),P(o.userId),l.next=29;break;case 27:return l.next=29,regeneratorRuntime.awrap(regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,regeneratorRuntime.awrap(p.default.attemptMigrationOfLegacyAuthentication());case 3:t.next=10;break;case 5:return t.prev=5,t.t0=t.catch(0),t.next=9,regeneratorRuntime.awrap(p.default.logout());case 9:R.remoteLogger.error(R.sources.STARTUP,'Failed to migrate user from legacy authentication',t.t0&&(0,S.stringifyError)(t.t0));case 10:case"end":return t.stop()}},null,null,[[0,5]]));case 29:case"end":return l.stop()}})},e.default=void 0;var t=r(d[0]),n=U(r(d[1]));r(d[2]);var s=U(r(d[3])),o=r(d[4]),u=r(d[5]),c=r(d[6]),l=r(d[7]),f=r(d[8]),p=U(r(d[9])),v=U(r(d[10])),x=U(r(d[11])),h=r(d[12]),b=r(d[13]),R=r(d[14]),S=r(d[15]);function U(t){return t&&t.__esModule?t:{default:t}}var k=!1,y=t.AppState.currentState;function I(){(0,x.default)(),(0,h.setAccessibilityFontMultiplierSize)()}function T(t){y.match(/inactive|background/)&&'active'===t&&I(),y=t}var w=(0,v.default)(function(s){k||(console.log('[initial-setup] Performing setup of RN-apps'),n.default.locale('en'===s.language?'en':'nb'),n.default.tz.setDefault('Europe/Oslo'),(0,o.setLanguage)(s.language),(0,b.setIsNotchPhone)(s.isNotchPhone),I(),t.AppState.addEventListener('change',T),k=!0)},500);function P(n){var o,u;return regeneratorRuntime.async(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,regeneratorRuntime.awrap((0,l.getUserProfile)(n));case 3:o=v.sent,(0,c.setUserId)(o.userId),(0,f.setUserProfileState)(o),v.next=22;break;case 8:if(v.prev=8,v.t0=v.catch(0),!(u=v.t0&&v.t0.response&&v.t0.response.status)){v.next=20;break}if(!(401===u||403===u)){v.next=17;break}return v.next=16,regeneratorRuntime.awrap(p.default.logout());case 16:t.Alert.alert((0,s.default)('logout_alert_header'),(0,s.default)('logout_alert_body'));case 17:R.remoteLogger.error(R.sources.STARTUP,'Failed to update user from backend on startup with statusCode',{statusCode:u}),v.next=21;break;case 20:R.remoteLogger.error(R.sources.STARTUP,'Failed to update user from backend on startup',{message:v.t0&&v.t0.error&&v.t0.error.message});case 21:R.remoteLogger.error(R.sources.STARTUP,'Failed to update user',v.t0&&(0,S.stringifyError)(v.t0));case 22:case"end":return v.stop()}},null,null,[[0,8]])}e.default=w},1863,[10,628,1864,1865,672,639,636,616,637,635,983,1866,979,968,633,671]);