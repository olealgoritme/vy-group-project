__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(d[0]),n=l(r(d[1])),o=l(r(d[2])),s=r(d[3]),u=l(r(d[4])),c=l(r(d[5])),f=r(d[6]);function l(t){return t&&t.__esModule?t:{default:t}}function p(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function h(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?p(Object(o),!0).forEach(function(n){v(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):p(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function v(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function y(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function b(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function T(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&P(t,n)}function P(t,n){return(P=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var O=(function(l){function p(t){var n,s,u;y(this,p),s=this,n=!(u=k(p).call(this,t))||"object"!=typeof u&&"function"!=typeof u?T(s):u;var c=t.navigation.state.params.subscription;return n.state={startTime:(0,o.default)(c.startTime,'HHmm'),endTime:(0,o.default)(c.endTime,'HHmm'),active:c.active,weekdays:c.weekdays,showStartTime:!1,showEndTime:!1,diffMoreThanThreeHours:!1,hasError:!1,stationPairId:c.stationPairId},n.save=n.save.bind(T(n)),n.toggleStartTimePicker=n.toggleStartTimePicker.bind(T(n)),n.toggleEndTimePicker=n.toggleEndTimePicker.bind(T(n)),n.toggleActive=n.toggleActive.bind(T(n)),n.showWeekdayPicker=n.showWeekdayPicker.bind(T(n)),n}var P,O,E;return w(p,n.default.Component),P=p,(O=[{key:"save",value:function(){var n=this,o=_(this);(0,s.updateSubscription)(o).then(function(t){n.alertSuccess(),n.props.navigation.state.params.onSave()}).catch(function(n){console.log('Saving subscription failed: '+JSON.stringify(n)),t.Alert.alert((0,u.default)('save_subscription_failed'))})}},{key:"alertSuccess",value:function(){(0,f.hasPushPermissionForApp)().then(function(n){n?t.Alert.alert((0,u.default)('save_subscription_ok_title'),(0,u.default)('save_subscription_ok')):t.Alert.alert((0,u.default)('action_needed'),(0,u.default)('approve_push_for_device'),[{text:(0,u.default)('settings'),onPress:function(){return(0,f.openSettingsPage)()},style:'cancel'},{text:(0,u.default)('settings_later'),style:'default'}])})}},{key:"toggleStartTimePicker",value:function(){this.setState({showStartTime:!this.state.showStartTime,showEndTime:!1})}},{key:"toggleEndTimePicker",value:function(){this.setState({showStartTime:!1,showEndTime:!this.state.showEndTime})}},{key:"updateStartTime",value:function(t){var n=t.isAfter(this.state.endTime)?t:this.state.endTime,o=S(t,n);this.setState(o)}},{key:"updateEndTime",value:function(t){var n=t.isBefore(this.state.startTime)?t:this.state.startTime,o=S(n,t);this.setState(o)}},{key:"showWeekdayPicker",value:function(){var t=this;this.setState({showStartTime:!1,showEndTime:!1}),this.props.navigation.navigate('SubscriptionWeekdayChooser',{weekdays:this.state.weekdays,onDaysChanged:function(n){return t.updateWeekdays(n)}})}},{key:"updateWeekdays",value:function(t){this.setState({weekdays:h({},this.state.weekdays,v({},t.name,!t.value))})}},{key:"toggleActive",value:function(){this.setState({active:!this.state.active})}},{key:"render",value:function(){var t=this,o=this.props.navigation.state.params,s=o.subscription,u=o.isNew;return n.default.createElement(c.default,{subscription:s,state:this.state,isNew:u,toggleStartTimePicker:this.toggleStartTimePicker,toggleEndTimePicker:this.toggleEndTimePicker,updateStartTime:function(n){return t.updateStartTime(n)},updateEndTime:function(n){return t.updateEndTime(n)},showWeekdayPicker:this.showWeekdayPicker,toggleActive:this.toggleActive,save:this.save,hasError:this.state.hasError})}}])&&b(P.prototype,O),E&&b(P,E),p})();O.navigationOptions=function(t){t.navigation;return{headerTitle:(0,u.default)('title_bar')}};var S=function(t,n){return{hasError:n.diff(t,'minutes')>180,startTime:t,endTime:n}},_=function(t){var n=t.state,o=t.props;return{from:o.navigation.state.params.subscription.from,to:o.navigation.state.params.subscription.to,startTime:n.startTime.format('HHmm'),endTime:n.endTime.format('HHmm'),active:n.active,weekdays:n.weekdays,stationPairId:n.stationPairId}},E=O;e.default=E},1800,[10,7,628,1635,1801,1802,632]);