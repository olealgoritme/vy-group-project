__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=E();if(n&&n.has(t))return n.get(t);var s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u=o?Object.getOwnPropertyDescriptor(t,c):null;u&&(u.get||u.set)?Object.defineProperty(s,c,u):s[c]=t[c]}s.default=t,n&&n.set(t,s);return s})(r(d[0])),n=r(d[1]),s=r(d[2]),o=M(r(d[3])),c=M(r(d[4])),u=M(r(d[5])),f=r(d[6]),l=r(d[7]),h=M(r(d[8])),p=M(r(d[9])),v=M(r(d[10])),k=M(r(d[11])),y=M(r(d[12])),T=r(d[13]),b=r(d[14]),_=r(d[15]),O=r(d[16]),w=r(d[17]),R=r(d[18]),S=r(d[19]),F=r(d[20]);function M(t){return t&&t.__esModule?t:{default:t}}function E(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return E=function(){return t},t}function j(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function P(t,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&L(t,n)}function L(t,n){return(L=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var N=(function(M){function E(t){var n,s,o;return j(this,E),s=this,(n=!(o=x(E).call(this,t))||"object"!=typeof o&&"function"!=typeof o?A(s):o).state={tickets:[],fetchedAt:'',isFetching:!0,isRefreshing:!1,tickerMessages:void 0},n.handleNavigatedTo=n.handleNavigatedTo.bind(A(n)),n}var L,N,D;return C(E,t.Component),L=E,(N=[{key:"componentDidMount",value:function(){this.getTickets(),this.getTickerMessages()}},{key:"getTickets",value:function(){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regeneratorRuntime.awrap((0,l.getActiveTicketsFromCache)());case 3:t=n.sent,this.setTickets(t),this.fetchTicketsFromServer(),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),S.remoteLogger.error(F.TICKETS,'getTickets() failed',{error:n.t0}),this.setState({isFetching:!1});case 12:case"end":return n.stop()}},null,this,[[0,8]])}},{key:"getTickerMessages",value:function(){var t,n;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap((0,w.getFeatureToggles)());case 2:if(!(t=s.sent)||!t.showTickerMessages){s.next=8;break}return s.next=6,regeneratorRuntime.awrap((0,O.getTickerMessagesFromCacheOrRemote)());case 6:(n=s.sent)&&n.ticketsMessage&&this.setState({tickerMessages:n});case 8:case"end":return s.stop()}},null,this)}},{key:"setTickets",value:function(t){var s=t.tickets,o=t.fetchedAt;n.LayoutAnimation.configureNext({duration:300,update:{type:n.LayoutAnimation.Types.easeInEaseOut,property:n.LayoutAnimation.Properties.opacity,springDamping:.9}}),this.setState({tickets:s,fetchedAt:o,isFetching:!1,isRefreshing:!1})}},{key:"fetchTicketsFromServer",value:function(){var t;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return this.setState({isRefreshing:!0}),s.prev=1,s.next=4,regeneratorRuntime.awrap((0,f.fetchActiveTickets)());case 4:t=s.sent,this.setTickets({tickets:t,fetchedAt:(0,o.default)()}),s.next=13;break;case 8:s.prev=8,s.t0=s.catch(1),this.setState({isFetching:!1,isRefreshing:!1}),S.remoteLogger.error(F.TICKETS,'Fetching active tickets from server failed',{error:s.t0}),n.Alert.alert((0,y.default)('fetch_tickets_failed_title'),(0,R.getMessageFromErrorIfPresent)(s.t0)||(0,y.default)('fetch_tickets_failed'));case 13:case"end":return s.stop()}},null,this,[[1,8]])}},{key:"handleNavigatedTo",value:function(){(0,b.clearBadgeCountForTab)(_.TicketsStack),this.getTickets()}},{key:"onRefresh",value:function(){this.fetchTicketsFromServer()}},{key:"onTicketStateChange",value:function(){this.forceUpdate()}},{key:"render",value:function(){var n=this;return t.default.createElement(c.default,{style:{backgroundColor:T.colors.brightGrey}},t.default.createElement(s.NavigationEvents,{onWillFocus:this.handleNavigatedTo}),this.state.isFetching?t.default.createElement(h.default,null):t.default.createElement(k.default,null,t.default.createElement(u.default,{tickets:this.state.tickets,onTicketStateChange:this.onTicketStateChange.bind(this),onRefresh:this.onRefresh.bind(this),isRefreshing:this.state.isRefreshing,blankSlate:t.default.createElement(p.default,{fetchedAt:this.state.fetchedAt}),tickerMessages:this.state.tickerMessages,footer:t.default.createElement(v.default,{navigation:this.props.navigation,refreshTicketList:function(){return n.fetchTicketsFromServer()}})})))}}])&&P(L.prototype,N),D&&P(L,D),E})();N.navigationOptions=function(){return{headerTitle:(0,y.default)('tickets_title_bar'),headerTitleContainerStyle:void 0}};var D=N;e.default=D},1543,[7,10,435,628,1266,1544,662,663,1184,1630,1632,1645,673,414,1646,1331,616,647,636,633,649]);