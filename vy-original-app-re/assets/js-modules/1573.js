__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=b(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),u=h(r(d[4])),c=r(d[5]),f=h(r(d[6])),l=h(r(d[7])),p=r(d[8]),v=b(r(d[9]));function h(t){return t&&t.__esModule?t:{default:t}}function y(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return y=function(){return t},t}function b(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=y();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var c=s?Object.getOwnPropertyDescriptor(t,u):null;c&&(c.get||c.set)?Object.defineProperty(o,u,c):o[u]=t[u]}return o.default=t,n&&n.set(t,o),o}function S(t,n){return O(t)||T(t,n)||k()}function k(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function T(t,n){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var o=[],s=!0,u=!1,c=void 0;try{for(var f,l=t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();!(s=(f=l.next()).done)&&(o.push(f.value),!n||o.length!==n);s=!0);}catch(t){u=!0,c=t}finally{try{s||null==l.return||l.return()}finally{if(u)throw c}}return o}}function O(t){if(Array.isArray(t))return t}function w(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&E(t,n)}function E(t,n){return(E=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var P=n.Dimensions.get('window').width,Q=(function(o){function h(t){var n,o,s;return w(this,h),o=this,(n=!(s=j(h).call(this,t))||"object"!=typeof s&&"function"!=typeof s?R(o):s).state={isQrVisible:!1,qrCodeSize:0,activeSeatReservation:void 0},n.onGestureEvent=n.onGestureEvent.bind(R(n)),n.onToggleQrCode=n.onToggleQrCode.bind(R(n)),n}var y,b,k;return C(h,t.Component),y=h,(b=[{key:"componentDidMount",value:function(){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:(0,s.isPeriodTicketWithSeatReservations)(this.props.ticket)&&this.fetchReservationData();case 1:case"end":return t.stop()}},null,this)}},{key:"onToggleQrCode",value:function(){this.setState({isQrVisible:!this.state.isQrVisible})}},{key:"setQRSizeAfterLayout",value:function(t){var n=t.nativeEvent.layout,o=n.height,s=n.width;if(!this.state.isQrVisible){var u=Math.min(o,s);this.setState({qrCodeSize:D(u,this.props.ticket)})}}},{key:"fetchReservationData",value:function(){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regeneratorRuntime.awrap((0,c.getReservationDataForTicket)(this.props.ticket.ticketId));case 3:t=n.sent,this.setReservationData(t),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log('Failed to get reservation-data');case 10:case"end":return n.stop()}},null,this,[[0,7]])}},{key:"setReservationData",value:function(t){var n=S(t.journeyReservations.sort(p.sortByDepartureTime).filter(function(t){return(0,p.isJourneyActive)(t.departureTime,t.arrivalTime)}),1)[0];if(n){var o=S(n.legs.filter(function(t){return(0,p.isJourneyActive)(t.departureTime,t.arrivalTime)}),1)[0];this.setState({activeSeatReservation:o})}}},{key:"onGestureEvent",value:function(t){t.persist();var n=t.touchHistory.touchBank[t.touchHistory.indexOfSingleActiveTouch],o=n.currentPageX-n.startPageX,s=n.currentPageY-n.startPageY,u=n.currentTimeStamp-n.startTimeStamp;o>=.8*P&&s<=50&&u<=2e3&&this.props.onTicketScannedByStaff(this.props.ticket.ticketId)}},{key:"render",value:function(){var o=this,s=this.props,c=s.ticket,p=s.validationData,h=s.isFetching,y=s.retrievalError;return t.default.createElement(n.View,{onLayout:function(t){return o.setQRSizeAfterLayout(t)},style:[v.default.inspectionDataContainer,{justifyContent:this.state.isQrVisible?'center':'flex-start'}]},this.state.isQrVisible&&t.default.createElement(f.default,{ticket:c,isTicketScannedByStaff:this.props.isTicketScannedByStaff,onGestureEvent:this.onGestureEvent,data:(0,u.default)(p,'qrCode'),onToggleQrCode:this.onToggleQrCode,qrCodeSize:this.state.qrCodeSize}),!this.state.isQrVisible&&t.default.createElement(l.default,{ticket:c,activeSeatReservation:this.state.activeSeatReservation,onToggleQrCode:this.onToggleQrCode,validationData:p,isFetching:h,retrievalError:y}))}}])&&_(y.prototype,b),k&&_(y,k),h})(),D=function(t,n){var u=Math.min(t-5*v.CONTENT_MARGIN_HORIZONTAL,200);return(0,s.isKolumbusTicket)(n)?Math.min(u,o.KOLUMBUS_MAX_SIZE):u},M=Q;e.default=M},1573,[7,10,414,669,627,1480,1574,1610,1622,1570]);