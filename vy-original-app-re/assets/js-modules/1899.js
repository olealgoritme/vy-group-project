__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=w();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var l=s?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=r(d[3]),c=r(d[4]),l=r(d[5]),u=r(d[6]),p=r(d[7]),f=r(d[8]),O=r(d[9]),y=P(r(d[10])),v=P(r(d[11])),b=P(r(d[12])),h=P(r(d[13]));function P(t){return t&&t.__esModule?t:{default:t}}function w(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return w=function(){return t},t}function _(){return(_=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t}).apply(this,arguments)}function j(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function x(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?j(Object(o),!0).forEach(function(n){E(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):j(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function E(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function C(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function k(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&T(t,n)}function T(t,n){return(T=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var L={contentContainer:{paddingTop:40,paddingBottom:30,paddingHorizontal:12}},M=(function(n){function l(t){var n,o,s;C(this,l),o=this,n=!(s=I(l).call(this,t))||"object"!=typeof s&&"function"!=typeof s?S(o):s;var c=t.navigation.state.params.itinerary.priceOptions.findIndex(function(t){return!t.unavailableReason})||0;return n.state={isCreatingOrder:!1,selectedPriceOptionIndex:c},n.renderPriceOption=n.renderPriceOption.bind(S(n)),n}var O,P,w;return R(l,t.Component),O=l,(P=[{key:"createOrder",value:function(){var t,n,s,c,l,u,O;return regeneratorRuntime.async(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,this.setState({isCreatingOrder:!0}),t=this.props.navigation.state.params.itinerary,n=t.id,s=t.priceOptions,c=s[this.state.selectedPriceOptionIndex].priceType,y.next=6,regeneratorRuntime.awrap((0,f.createOrder)(n,c));case 6:return l=y.sent,u=l.id,y.next=10,regeneratorRuntime.awrap((0,f.getOrder)(u));case 10:O=y.sent,this.navigateToNextScreen(O),y.next=17;break;case 14:y.prev=14,y.t0=y.catch(0),o.Alert.alert((0,h.default)('order_or_payment_failed_alert_title'),(0,p.getMessageFromErrorIfPresent)(y.t0)||(0,h.default)('initiate_order_failed_generic_message'));case 17:return y.prev=17,this.setState({isCreatingOrder:!1}),y.finish(17);case 20:case"end":return y.stop()}},null,this,[[0,14,17,20]])}},{key:"navigateToNextScreen",value:function(t){var n=t.itineraries[0],o=this.props.navigation.state.params.isLoggedIn,s=n.seatReservationAvailableOnAnyLegs?'AccommodationChooser':!1===o?'BookingLoginScreen':'OrderConfirmation';this.props.navigation.navigate(s,x({},this.props.navigation.state.params,{order:t,itinerary:n,orderId:t.id}))}},{key:"handlePriceOptionClicked",value:function(t){this.setState({selectedPriceOptionIndex:t})}},{key:"renderPriceOption",value:function(n){var o,s,c,l=this,p=n.item,f=n.index,O=this.props.navigation.state.params.itinerary,y=(0,u.getCheapestPriceOption)(O.priceOptions),v=p.amountInOere||0,P=v||(null!=(o=p.unavailableReason)?o:''),w=null!=(s=null==(c=p.sellingPoints)?void 0:c.reduce(function(t,n){var o=n.included?(0,h.default)('included'):(0,h.default)('not_included');return t+(n.text+': '+o+'. ')},''))?s:'',_=(0,h.default)('accessibility_price_option')+': '+p.name+'. '+(0,h.default)('ticket_price')+': '+P+'. '+(0,h.default)('selling_points')+': '+w;return t.default.createElement(b.default,{onPress:function(){return l.handlePriceOptionClicked(f)},accessibilityLabel:_,isUnavailable:Boolean(p.unavailableReason),unavailableReason:p.unavailableReason||'',isActive:f===this.state.selectedPriceOptionIndex,isCheapestOption:p===y,description:p.name,tagline:p.tagline||'',sellingPoints:p.sellingPoints||[],price:v})}},{key:"render",value:function(){var n=this,l=this.props.navigation.state.params,u=l.itinerary,p=l.passengerCategories,f=l.passengers,O=u.priceOptions[this.state.selectedPriceOptionIndex];return t.default.createElement(t.default.Fragment,null,t.default.createElement(o.View,{ref:this.props.forwardedRef,style:{zIndex:10}},t.default.createElement(s.HeaderCard,null,t.default.createElement(y.default,{showBackButton:!0,showCloseButton:!0,showVerticalLine:!0,headerText:(0,h.default)('price_options'),isLoading:this.state.isCreatingOrder}))),t.default.createElement(o.FlatList,{contentContainerStyle:L.contentContainer,data:u.priceOptions,extraData:this.state.selectedPriceOptionIndex,keyExtractor:function(t){return t.name},keyboardShouldPersistTaps:"always",renderItem:this.renderPriceOption}),t.default.createElement(v.default,{isLoading:this.state.isCreatingOrder,onPress:function(){n.createOrder()},text:(0,h.default)('go_further')},t.default.createElement(B,{chosenPriceOption:O,passengerSummary:(0,c.getPassengerSelectionSummary)(f,p)})))}}])&&k(O.prototype,P),w&&k(O,w),l})(),B=function(n){var c=n.passengerSummary,u=n.chosenPriceOption,p=(0,l.getAmountFromOereWithCurrency)(u.amountInOere),f=(0,h.default)('chosen_price_options')+': '+u.name+'. '+c+', '+p;return t.default.createElement(o.View,{accessible:!0,accessibilityRole:"summary",accessibilityLabel:f},t.default.createElement(o.View,{style:{flexDirection:'row',alignItems:'center'}},t.default.createElement(o.Image,{resizeMode:"contain",source:O.ticketBlack}),t.default.createElement(s.MediumTextBold,{style:{paddingLeft:6}},u.name)),t.default.createElement(s.MediumText,null,c),t.default.createElement(s.MediumTextBold,{actionGreen:!0},p))},D=(0,n.withNavigation)(t.default.forwardRef(function(n,o){return t.default.createElement(M,_({},n,{forwardedRef:o}))}));e.default=D},1899,[7,435,10,653,1296,1236,1228,636,642,675,1715,1741,1873,1234]);