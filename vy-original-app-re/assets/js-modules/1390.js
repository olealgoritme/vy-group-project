__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=T();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(Object.prototype.hasOwnProperty.call(t,u)){var l=s?Object.getOwnPropertyDescriptor(t,u):null;l&&(l.get||l.set)?Object.defineProperty(o,u,l):o[u]=t[u]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=k(r(d[2])),s=k(r(d[3])),u=r(d[4]),l=r(d[5]),c=r(d[6]),f=r(d[7]),p=k(r(d[8])),h=k(r(d[9])),v=r(d[10]),y=r(d[11]),b=r(d[12]);function k(t){return t&&t.__esModule?t:{default:t}}function T(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return T=function(){return t},t}function O(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function _(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?O(Object(o),!0).forEach(function(n){S(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):O(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function S(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function P(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function w(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&j(t,n)}function j(t,n){return(j=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var M=(function(k){function T(t){var s,l,c;return P(this,T),l=this,c=E(T).call(this,t),(s=!c||"object"!=typeof c&&"function"!=typeof c?A(l):c).onTimeChange=function(t){var l=(0,o.default)().add(u.DATEPICKER_MAXIUMUM_FUTURE_DAYS,'days');(t.isSame(l,'day')||t.isAfter(l))&&!s.state.shouldSetMaximumDate&&n.Alert.alert('',(0,h.default)('max_days_alert'),[{text:'OK',onPress:function(){return s.setState({shouldSetMaximumDate:!0})}}],{cancelable:!1}),s.setState({selectedTime:t,didChangeTime:!0})},s.state={selectedTime:(0,o.default)(),didChangeTime:!1,hasResponse:!1,ticketAlternatives:{periodTicketAvailable:!1,busDeparturesAvailable:!1,useNewDeparturesList:!0,hereAndNowTicketAvailable:!1},shouldSetMaximumDate:!1,loading:!1},s.onBackButtonPressed=s.onBackButtonPressed.bind(A(s)),s}var O,S,j;return D(T,t.Component),O=T,(S=[{key:"componentDidMount",value:function(){var t=this.props.navigation.state.params,n=t.from,o=t.to;(0,v.isTrainStations)(n,o)&&this.getTicketAlternatives()}},{key:"getTicketAlternatives",value:function(){var t,n,o,s;return regeneratorRuntime.async(function(u){for(;;)switch(u.prev=u.next){case 0:return t=this.props.navigation.state.params,n=t.from,o=t.to,u.prev=1,u.next=4,regeneratorRuntime.awrap((0,l.fetchTicketAlternatives)({code:n.id,country:n.country,name:n.name},{code:o.id,country:o.country,name:o.name}));case 4:s=u.sent,this.setState({ticketAlternatives:s,hasResponse:!0}),u.next=11;break;case 8:u.prev=8,u.t0=u.catch(1),console.log('Failed to get ticket alternatives with error:',u.t0);case 11:case"end":return u.stop()}},null,this,[[1,8]])}},{key:"onSeasonTicketClicked",value:function(){var t,o,s,u,c,f,p;return regeneratorRuntime.async(function(v){for(;;)switch(v.prev=v.next){case 0:if(t=this.state,o=t.selectedTime,s=t.ticketAlternatives.periodTicketAvailable,this.setState({loading:!0}),!s){v.next=15;break}return u=this.props.navigation.state.params,c=u.from,f=u.to,v.prev=4,v.next=7,regeneratorRuntime.awrap((0,l.getPeriodTicketOptions)((0,y.mapStationToLegacyStation)(c),(0,y.mapStationToLegacyStation)(f),o));case 7:p=v.sent,this.props.navigation.navigate('PeriodTicket',_({periodTicketOptions:p,from:c,to:f,selectedTime:o},this.props.navigation.state.params)),v.next=15;break;case 11:v.prev=11,v.t0=v.catch(4),console.log('e: ',v.t0),n.Alert.alert((0,h.default)('period_ticket_error'),(0,b.getMessageFromErrorIfPresent)(v.t0)||'');case 15:this.setState({loading:!1});case 16:case"end":return v.stop()}},null,this,[[4,11]])}},{key:"onSingleTicketClicked",value:function(){var t=this.state.selectedTime,n=this.isBusDeparturesAvailable();if(this.props.navigation.navigate('BookingDepartures',_({selectedTime:t,busDeparturesAvailable:n},this.props.navigation.state.params)),s.default.DID_USER_CHANGE_TRAVEL_TIME_IN_SEARCH({didChangeTime:String(this.state.didChangeTime)}),this.state.didChangeTime){var u=o.default.duration(t.diff((0,o.default)()));s.default.TRAVEL_TIME_SEARCH_OFFSET({inMinutes:String(u.asMinutes())})}}},{key:"isBusDeparturesAvailable",value:function(){return!!this.journeyIsBusDeparture()||this.state.ticketAlternatives.busDeparturesAvailable}},{key:"journeyIsBusDeparture",value:function(){var t=this.props.navigation.state.params;return(0,v.isBusStations)(t.from,t.to)}},{key:"onBackButtonPressed",value:function(){this.props.navigation.goBack()}},{key:"render",value:function(){var s=this,l=this.state.ticketAlternatives.periodTicketAvailable;return t.default.createElement(c.ScreenView,null,t.default.createElement(n.View,{style:p.default.arrow()},t.default.createElement(n.TouchableOpacity,{onPress:this.onBackButtonPressed,style:p.default.backButton,accessibilityLabel:(0,h.default)('back'),accessibilityRole:"button"},t.default.createElement(c.Arrow,null))),t.default.createElement(c.Content,{style:p.default.content},t.default.createElement(n.ScrollView,{showsVerticalScrollIndicator:!1,style:p.default.datePickerContainer},t.default.createElement(c.MediumLargeText,{allowFontScaling:!1,style:p.default.header()},(0,h.default)('datetime_selection_header')+' ',t.default.createElement(c.MediumLargeTextBold,{style:p.default.headerStation},this.props.navigation.state.params.from.name),' '+(0,h.default)('datetime_selection_middlesection')+' ',t.default.createElement(c.MediumLargeTextBold,{style:p.default.headerStation},this.props.navigation.state.params.to.name),'?'),t.default.createElement(c.DatePicker,{style:p.default.datePicker(),date:this.state.selectedTime,onDateChange:function(t){return s.onTimeChange(t)},maximumDate:(0,o.default)().add(u.DATEPICKER_MAXIUMUM_FUTURE_DAYS,'days'),minimumDate:(0,o.default)().subtract(1,'days').startOf('day'),shouldSetMaximumDate:this.state.shouldSetMaximumDate})),t.default.createElement(n.View,{style:p.default.buttonContainer},l&&t.default.createElement(c.SecondaryButton,{children:(0,h.default)('buy_season_ticket_button'),icon:f.periodTicketBooking,containerStyle:{marginBottom:18},onPress:function(){return s.onSeasonTicketClicked()},loading:this.state.loading}),t.default.createElement(c.PrimaryButton,{children:(0,h.default)('view_departures_button'),icon:f.ticket,onPress:function(){return s.onSingleTicketClicked()}}))))}}])&&w(O.prototype,S),j&&w(O,j),T})();M.navigationOptions=function(){return{header:null}};var B=M;e.default=B},1390,[7,10,628,1294,416,642,653,675,1391,1234,1331,1331,636]);