__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=v();if(n&&n.has(t))return n.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u=s?Object.getOwnPropertyDescriptor(t,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=t[c]}o.default=t,n&&n.set(t,o);return o})(r(d[0])),n=r(d[1]),o=r(d[2]),s=h(r(d[3])),c=r(d[4]),u=r(d[5]),l=h(r(d[6])),f=h(r(d[7])),p=h(r(d[8]));function h(t){return t&&t.__esModule?t:{default:t}}function v(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return v=function(){return t},t}function b(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),o.push.apply(o,s)}return o}function y(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?b(Object(o),!0).forEach(function(n){O(t,n,o[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):b(Object(o)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))})}return t}function O(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function _(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function P(t,n){for(var o=0;o<n.length;o++){var s=n[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&k(t,n)}function k(t,n){return(k=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var C=(function(h){function v(){var t,n,o,s;_(this,v);for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];return o=this,(n=!(s=(t=j(v)).call.apply(t,[this].concat(u)))||"object"!=typeof s&&"function"!=typeof s?w(o):s).state={loginToken:'',userId:'',consents:[],isLoading:!1},n}var b,O,k;return S(v,t.Component),b=v,(O=[{key:"componentDidMount",value:function(){var t=this.props.navigation.state.params,n=t.loginToken,o=t.userId;this.fetchConsents(o),this.setState({loginToken:n,userId:o})}},{key:"fetchConsents",value:function(t){var s,u=this;return regeneratorRuntime.async(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,regeneratorRuntime.awrap((0,c.getConsentsForUser)(t));case 3:s=l.sent,this.setState({consents:s}),l.next=11;break;case 7:l.prev=7,l.t0=l.catch(0),console.log('Unable to fetch consents: '+l.t0),n.Alert.alert('',(0,p.default)('error_alert_user_created'),[{text:'OK',onPress:function(){u.props.navigation.dispatch(o.NavigationActions.navigate({routeName:'ProfileStack'}))}}],{cancelable:!1});case 11:case"end":return l.stop()}},null,this,[[0,7]])}},{key:"handleFinishButtonUpdateConsents",value:function(){var t,s=this;return regeneratorRuntime.async(function(u){for(;;)switch(u.prev=u.next){case 0:return this.setState({isLoading:!0}),t=this.state.consents.map(function(t){return{code:t.code,state:t.state}}),u.prev=2,u.next=5,regeneratorRuntime.awrap((0,c.updateConsentsForUser)(this.state.userId,t));case 5:this.navigateToFinishScreen(),u.next=13;break;case 8:u.prev=8,u.t0=u.catch(2),console.log('Unable to update consents: '+u.t0),this.setState({isLoading:!1}),n.Alert.alert('',(0,p.default)('error_alert_user_created'),[{text:'OK',onPress:function(){s.props.navigation.dispatch(o.NavigationActions.navigate({routeName:'ProfileStack'}))}}],{cancelable:!1});case 13:case"end":return u.stop()}},null,this,[[2,8]])}},{key:"navigateToFinishScreen",value:function(){this.props.navigation.getParam('skipFinishStep')?this.props.navigation.navigate(this.props.navigation.getParam('afterCompletionNavigateTo')):this.props.navigation.navigate('NewProfileFinishScreen',{firstName:this.props.navigation.state.params.firstName})}},{key:"handleToggleChange",value:function(t,n){var o=this.state.consents.map(function(o){return o.code===t?(n&&s.default.TOGGLED_COMMUNICATION_CONSENT_NEW_PROFILE({summary:o.summary}),y({},o,{state:n})):o});this.setState({consents:o})}},{key:"render",value:function(){var n=this,o=this.state,s=o.consents,c=o.isLoading,h=o.userId;return t.default.createElement(u.ScreenView,null,t.default.createElement(f.default,{accessibleHeaderTitle:(0,p.default)('accessible_consents_title'),screenName:"CONSENTS_SCREEN",rightButton:(0,p.default)('finish_button'),rightButtonAction:function(){return n.handleFinishButtonUpdateConsents()}}),t.default.createElement(l.default,{userId:h,toggles:s,onToggleChange:function(t,o){return n.handleToggleChange(t,o)}}),t.default.createElement(u.ModalBottomButton,{showShadow:!0,text:(0,p.default)('finish_button'),loading:c,disabled:c,onPress:function(){return n.handleFinishButtonUpdateConsents()}}))}}])&&P(b.prototype,O),k&&P(b,k),v})();e.default=C},1501,[7,10,435,1294,616,653,1502,1493,1494]);