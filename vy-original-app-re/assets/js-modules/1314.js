__d(function(g,r,i,a,m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=S();if(n&&n.has(t))return n.get(t);var s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var u=o?Object.getOwnPropertyDescriptor(t,l):null;u&&(u.get||u.set)?Object.defineProperty(s,l,u):s[l]=t[l]}s.default=t,n&&n.set(t,s);return s})(r(d[0])),n=r(d[1]),s=r(d[2]),o=r(d[3]),l=_(r(d[4])),u=r(d[5]),c=r(d[6]),f=_(r(d[7])),p=_(r(d[8])),y=_(r(d[9])),h=_(r(d[10])),v=_(r(d[11])),E=_(r(d[12])),b=_(r(d[13])),P=_(r(d[14])),O=_(r(d[15])),x=_(r(d[16])),w=r(d[17]);function _(t){return t&&t.__esModule?t:{default:t}}function S(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return S=function(){return t},t}function M(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function I(t,n){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var s=[],o=!0,l=!1,u=void 0;try{for(var c,f=t["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();!(o=(c=f.next()).done)&&(s.push(c.value),!n||s.length!==n);o=!0);}catch(t){l=!0,u=t}finally{try{o||null==f.return||f.return()}finally{if(l)throw u}}return s}}function j(t){if(Array.isArray(t))return t}function C(t,n){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,o)}return s}function A(t){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?C(Object(s),!0).forEach(function(n){T(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function T(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function R(t){return N(t)||D(t)||k()}function k(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function D(t){if(("function"==typeof Symbol?Symbol.iterator:"@@iterator")in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function N(t){if(Array.isArray(t)){for(var n=0,s=new Array(t.length);n<t.length;n++)s[n]=t[n];return s}}function L(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function B(t,n){for(var s=0;s<n.length;s++){var o=n[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&V(t,n)}function V(t,n){return(V=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var z=function(t,n){var s;return n?null==t?void 0:null==(s=t.extras)?void 0:s.includes(n):(null==t?void 0:t.extras.length)>0},K=function(t,n){return t.prioritized&&n.prioritized?0:t.prioritized?-1:1},W=(function(_){function S(t){var n,s,o;return L(this,S),s=this,(n=!(o=G(S).call(this,t))||"object"!=typeof o&&"function"!=typeof o?F(s):o).state={passengers:t.passengers,userHasScrolledToInfoBox:!1,showPassengerCategoriesInfo:!1,showPassengerExtraInfo:!1,errorMessage:void 0},n.addPassenger=n.addPassenger.bind(F(n)),n.removePassengerAt=n.removePassengerAt.bind(F(n)),n.addExtra=n.addExtra.bind(F(n)),n.removeExtra=n.removeExtra.bind(F(n)),n.closeModal=n.closeModal.bind(F(n)),n.showPassengerCategoryModal=n.showPassengerCategoryModal.bind(F(n)),n.showPassengerExtraModal=n.showPassengerExtraModal.bind(F(n)),n}var C,T,k;return U(S,t.Component),C=S,(T=[{key:"componentDidUpdate",value:function(t){(0,u.arrayEquals)(t.passengers,this.props.passengers)||this.setState({passengers:this.props.passengers})}},{key:"addPassenger",value:function(t){this.setState(function(n){var o=[].concat(R(n.passengers),[t]);return{passengers:o,errorMessage:o.length===s.NUM_OF_PASSENGERS_ORDER_LIMIT?(0,O.default)('reached_maximum_travellers'):void 0}})}},{key:"removePassengerAt",value:function(t){var n,s=this.state.passengers[t];z(s,'BIKE')&&(n=(0,O.default)('bike_removed_with_passenger')),this.setState({passengers:this.state.passengers.filter(function(n,s){return s!==t}),errorMessage:n})}},{key:"togglePassengerCategory",value:function(t,n){if(-1===t){var s,o=this.state.passengers.reduce(function(t,s,o){return(0,c.isSameCategory)(s,n)?(z(s)&&(t.withExtra=o),t.withoutExtra=o,t):t},{});this.removePassengerAt(null!=(s=o.withoutExtra)?s:o.withExtra)}else this.addPassenger({type:n.type,discount:n.discount,extras:[],customerNumber:null})}},{key:"addExtra",value:function(t){var n=!1,s=this.state.passengers.map(function(s){return z(s,t)||n?s:(n=!0,A({},s,{extras:[].concat(R(s.extras),[t])}))});this.setState({passengers:s,errorMessage:void 0})}},{key:"removeExtra",value:function(t){var n=!1,s=this.state.passengers.map(function(s){return n||!z(s,t)?s:(n=!0,A({},s,{extras:s.extras.filter(function(n){return n!==t})}))});this.setState({passengers:s,errorMessage:void 0})}},{key:"showPassengerCategoryModal",value:function(){l.default.OPEN_PASS_CAT_MORE_INFO_MODAL(),this.setState({showPassengerCategoriesInfo:!0})}},{key:"showPassengerExtraModal",value:function(){l.default.OPEN_PASS_EXTRAS_MORE_INFO_MODAL(),this.setState({showPassengerExtraInfo:!0})}},{key:"closeModal",value:function(){this.setState({showPassengerCategoriesInfo:!1,showPassengerExtraInfo:!1})}},{key:"render",value:function(){var l,u,_=this,S=this.state,C=S.passengers,A=S.showPassengerCategoriesInfo,T=S.showPassengerExtraInfo,R=this.props,k=R.passengerCategories,D=R.availableExtras,N=R.employeeTicketRights,L=R.modality,B=C.length,G=C.filter(c.isCustomerCardCategory),F=k.filter(function(t){return null===t.discount}).sort(K),U=k.filter(c.isCustomerCardCategory),V=(u=1,j(l=U)||I(l,u)||M())[0],z=B>0&&B<=s.NUM_OF_PASSENGERS_ORDER_LIMIT,W=B===s.NUM_OF_PASSENGERS_ORDER_LIMIT,q=this.state.passengers.filter(function(t){var n;return null==(n=t.extras)?void 0:n.includes('BIKE')}).length,H=this.state.passengers.filter(function(t){var n;return null==(n=t.extras)?void 0:n.includes('STROLLER')}).length,X=this.state.passengers.filter(function(t){var n;return null==(n=t.extras)?void 0:n.includes('LARGE_DOG')}).length,J=this.state.passengers.filter(function(t){var n;return null==(n=t.extras)?void 0:n.includes('SMALL_PET')}).length,Q=H+J+X,Y=!z;return t.createElement(n.View,{style:{flex:1},accessibilityViewIsModal:!0},t.createElement(h.default,{validPassengerSelection:z,errorMessage:this.state.errorMessage,passengerSummary:(0,c.getPassengerSelectionSummary)(C,k),passengers:C,closeModal:this.props.onClose}),t.createElement(n.ScrollView,{style:x.default.formContainer,contentContainerStyle:{paddingBottom:100},keyboardShouldPersistTaps:"always"},t.createElement(v.default,{text:(0,O.default)('passengers_header'),onPress:this.showPassengerCategoryModal}),F.map(function(n){var s=(0,c.hasUnsupportedPassengerCategoryForModality)([n.type],L),o=!W&&!s,l=(0,c.getPassengerCategoryTagline)(n.type);return t.createElement(y.default,{key:""+n.type+(n.discount||'NONE'),categoryName:n.categoryName,categoryTagline:l,disabled:s,canIncrease:o,onIncrease:function(){return _.togglePassengerCategory(1,n)},onDecrease:function(){return _.togglePassengerCategory(-1,n)},small:!n.prioritized,count:C.filter(function(t){return t.type===n.type&&!t.discount}).length})}),t.createElement(p.default,{customerCardNumber:this.props.customerCardNumber,passengers:G,category:V,canIncrease:!W,addPassenger:this.addPassenger,removePassenger:function(t){var n=_.state.passengers.findIndex(t);_.removePassengerAt(n)}}),(null==N?void 0:N.hasEmployeeTicketRights)&&t.createElement(f.default,{employeeTicketRights:N,passengers:this.state.passengers,addPassenger:this.addPassenger,removePassengerAt:this.removePassengerAt}),t.createElement(o.GreyLine,{style:{marginTop:24,marginBottom:8}}),t.createElement(v.default,{text:(0,O.default)('passenger_extras_header'),onPress:this.showPassengerExtraModal}),t.createElement(n.View,{style:x.default.extrasContainer},t.createElement(E.default,{extraType:"BIKE",count:q,canIncrease:q<B,onIncrease:this.addExtra,onDecrease:this.removeExtra}),t.createElement(E.default,{extraType:"STROLLER",count:H,canIncrease:Q<B,onIncrease:this.addExtra,onDecrease:this.removeExtra}),t.createElement(E.default,{extraType:"SMALL_PET",count:J,canIncrease:Q<B,onIncrease:this.addExtra,onDecrease:this.removeExtra}),t.createElement(E.default,{extraType:"LARGE_DOG",count:X,canIncrease:Q<B,onIncrease:this.addExtra,onDecrease:this.removeExtra})),t.createElement(w.WheelchairInformation,{modality:L})),t.createElement(o.InformationModal,{isVisible:A||T,onClose:this.closeModal,headerContent:(0,O.default)(A?'passengers_header':'passenger_extras_header')},A?t.createElement(b.default,{categories:F}):t.createElement(P.default,{extras:D})),t.createElement(o.ModalBottomButton,{showShadow:!0,text:(0,O.default)('button'),disabled:Y,onPress:function(){return _.props.onSelectPassengers(C)},style:[x.default.confirmButton,Y?x.default.confirmButtonDisabled:{}]}))}}])&&B(C.prototype,T),k&&B(C,k),S})();e.default=W},1314,[7,10,414,653,1294,643,1296,1315,1318,1323,1324,1325,1326,1327,1328,1234,1317,1329]);